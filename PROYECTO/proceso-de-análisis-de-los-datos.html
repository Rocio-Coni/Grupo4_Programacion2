<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 PROCESO DE ANÁLISIS DE LOS DATOS | ANALISIS DE CLUSTER</title>
  <meta name="description" content="5 PROCESO DE ANÁLISIS DE LOS DATOS | ANALISIS DE CLUSTER" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5 PROCESO DE ANÁLISIS DE LOS DATOS | ANALISIS DE CLUSTER" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 PROCESO DE ANÁLISIS DE LOS DATOS | ANALISIS DE CLUSTER" />
  
  
  



<meta name="date" content="2021-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="adquisicion-de-datos.html"/>
<link rel="next" href="resultados.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="presentación.html"><a href="presentación.html"><i class="fa fa-check"></i><b>1</b> PRESENTACIÓN</a></li>
<li class="chapter" data-level="2" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>2</b> INTRODUCCIÓN</a></li>
<li class="chapter" data-level="3" data-path="objetivos.html"><a href="objetivos.html"><i class="fa fa-check"></i><b>3</b> OBJETIVOS</a></li>
<li class="chapter" data-level="4" data-path="adquisicion-de-datos.html"><a href="adquisicion-de-datos.html"><i class="fa fa-check"></i><b>4</b> ADQUISICION DE DATOS</a><ul>
<li class="chapter" data-level="4.1" data-path="adquisicion-de-datos.html"><a href="adquisicion-de-datos.html#fuente-de-data"><i class="fa fa-check"></i><b>4.1</b> Fuente de Data</a></li>
<li class="chapter" data-level="4.2" data-path="adquisicion-de-datos.html"><a href="adquisicion-de-datos.html#descripción-variables"><i class="fa fa-check"></i><b>4.2</b> Descripción Variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html"><i class="fa fa-check"></i><b>5</b> PROCESO DE ANÁLISIS DE LOS DATOS</a><ul>
<li class="chapter" data-level="5.1" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#análisis-exploratorio-de-datos"><i class="fa fa-check"></i><b>5.1</b> Análisis Exploratorio de Datos</a><ul>
<li class="chapter" data-level="5.1.1" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#importamos-los-datos"><i class="fa fa-check"></i><b>5.1.1</b> Importamos los datos</a></li>
<li class="chapter" data-level="5.1.2" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#eliminar-na"><i class="fa fa-check"></i><b>5.1.2</b> Eliminar NA</a></li>
<li class="chapter" data-level="5.1.3" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#eliminar-filas"><i class="fa fa-check"></i><b>5.1.3</b> Eliminar filas</a></li>
<li class="chapter" data-level="5.1.4" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#eliminar-columnas"><i class="fa fa-check"></i><b>5.1.4</b> Eliminar columnas</a></li>
<li class="chapter" data-level="5.1.5" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#gráfico-resumen"><i class="fa fa-check"></i><b>5.1.5</b> Gráfico resumen</a></li>
<li class="chapter" data-level="5.1.6" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#anlizando-las-variables"><i class="fa fa-check"></i><b>5.1.6</b> Anlizando las variables</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#análisis-de-componentes-principales"><i class="fa fa-check"></i><b>5.2</b> Análisis de Componentes Principales</a><ul>
<li class="chapter" data-level="5.2.1" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#justificación-del-análisis-de-componentes-principales"><i class="fa fa-check"></i><b>5.2.1</b> Justificación del Análisis de Componentes Principales</a></li>
<li class="chapter" data-level="5.2.2" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#proceso-análisis-del-pca"><i class="fa fa-check"></i><b>5.2.2</b> Proceso análisis del PCA</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#análisis-de-cluster"><i class="fa fa-check"></i><b>5.3</b> Análisis de cluster</a><ul>
<li class="chapter" data-level="5.3.1" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#matriz-de-distancias"><i class="fa fa-check"></i><b>5.3.1</b> Matriz de distancias</a></li>
<li class="chapter" data-level="5.3.2" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#metodo-jerárquico"><i class="fa fa-check"></i><b>5.3.2</b> Metodo Jerárquico</a></li>
<li class="chapter" data-level="5.3.3" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#proceso-de-agrupamiento"><i class="fa fa-check"></i><b>5.3.3</b> Proceso de agrupamiento</a></li>
<li class="chapter" data-level="5.3.4" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#método-k-means"><i class="fa fa-check"></i><b>5.3.4</b> Método K-means</a></li>
<li class="chapter" data-level="5.3.5" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#k-means"><i class="fa fa-check"></i><b>5.3.5</b> K-means</a></li>
<li class="chapter" data-level="5.3.6" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#k-means-1"><i class="fa fa-check"></i><b>5.3.6</b> K-means++</a></li>
<li class="chapter" data-level="5.3.7" data-path="proceso-de-análisis-de-los-datos.html"><a href="proceso-de-análisis-de-los-datos.html#k-medoids-pam"><i class="fa fa-check"></i><b>5.3.7</b> K-medoids PAM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="resultados.html"><a href="resultados.html"><i class="fa fa-check"></i><b>6</b> RESULTADOS</a><ul>
<li class="chapter" data-level="6.1" data-path="resultados.html"><a href="resultados.html#método-jerárquico"><i class="fa fa-check"></i><b>6.1</b> Método Jerárquico</a></li>
<li class="chapter" data-level="6.2" data-path="resultados.html"><a href="resultados.html#método-k-means-1"><i class="fa fa-check"></i><b>6.2</b> Método K-means</a></li>
<li class="chapter" data-level="6.3" data-path="resultados.html"><a href="resultados.html#método-k-means-2"><i class="fa fa-check"></i><b>6.3</b> Método K-means++</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusiones.html"><a href="conclusiones.html"><i class="fa fa-check"></i><b>7</b> CONCLUSIONES</a></li>
<li class="chapter" data-level="8" data-path="recomendaciones.html"><a href="recomendaciones.html"><i class="fa fa-check"></i><b>8</b> RECOMENDACIONES</a></li>
<li class="chapter" data-level="9" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i><b>9</b> BIBLIOGRAFIA</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ANALISIS DE CLUSTER</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="proceso-de-análisis-de-los-datos" class="section level1">
<h1><span class="header-section-number">5</span> PROCESO DE ANÁLISIS DE LOS DATOS</h1>
<div id="análisis-exploratorio-de-datos" class="section level2">
<h2><span class="header-section-number">5.1</span> Análisis Exploratorio de Datos</h2>
<p>Para el presente análisis usamos la data descargada anteriormente, las cuales exploraremos y ordenaremos adecuadamente dichos datos.</p>
<div id="importamos-los-datos" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Importamos los datos</h3>
<p>Cargamos los datos crudos y visualizamos los datos en desorden, y con valores NA, las cuales limpiamos y tranformamos.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="proceso-de-análisis-de-los-datos.html#cb1-1"></a>data0 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;DEPARTAMENTOS (1) - copia.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb1-2"><a href="proceso-de-análisis-de-los-datos.html#cb1-2"></a>DT<span class="op">::</span><span class="kw">datatable</span>(data0)</span></code></pre></div>
<div id="htmlwidget-a963d3ff7e1123ca0d82" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a963d3ff7e1123ca0d82">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["AMAZONAS","ANCASH","APURIMAC","AREQUIPA","AYACUCHO","CAJAMARCA","CALLAO","CUSCO","HUANCAVELICA","HUANUCO","ICA","JUNIN","LA LIBERTAD","LAMBAYEQUE","LIMA","LORETO","MADRE DE DIOS","MOQUEGUA","PASCO","PIURA","PUNO","SAN MARTIN","TACNA ","TUMBES","UCAYALI"],[379384,1083519,405759,1382730,616176,1341012,994494,1205527,347639,721047,850765,1246038,1778080,1197260,17769310,36885495,8530054,1573397,2531959,3589249,1172697,813381,329332,224863,496459],[2,2,2,3,2,4,1,3,1,1,2,7,2,1,10,3,1,1,2,1,3,4,3,1,1],[35,156,61,158,192,107,null,186,9,162,302,180,283,163,1884,74,null,null,14,94,190,62,110,37,104],[824,3179,549,2226,2347,1867,3199,2586,191,2392,4971,2861,4471,3000,24140,1172,712,null,181,3098,1597,2221,992,823,1949],[35,3,21,48,89,110,16,70,3,145,72,84,124,94,281,53,11,null,4,84,37,92,24,27,65],[3,3,null,null,5,3,4,3,null,8,3,14,9,5,29,1,3,null,1,1,2,6,2,83,1],[139,316,65,167,284,341,196,230,22,290,312,320,589,373,1740,136,70,null,10,310,200,422,75,156,207],[265,529,128,310,527,441,227,530,39,643,578,613,905,548,2873,259,115,null,26,619,298,564,156,201,413],[165,834,166,693,638,416,869,801,54,564,1665,803,1084,791,7452,285,195,null,81,805,556,398,314,297,456],[184,1164,168,659,733,399,990,727,42,650,1831,840,1518,999,9391,351,219,null,39,1000,403,560,335,23,690],[24,125,15,159,88,70,102,91,17,57,236,90,154,103,979,36,27,null,6,123,66,86,45,21,60],[16,87,13,127,62,44,92,102,6,59,233,78,159,94,962,38,16,null,5,134,51,52,35,11,73],[16,73,16,82,46,43,59,65,10,53,120,120,79,57,601,16,22,null,13,35,69,53,23,10,21],[9,98,16,97,53,47,65,107,6,75,161,12,105,71,758,31,19,null,9,54,85,29,41,1,41],[null,9,null,2,1,3,1,2,1,null,6,null,4,6,34,1,null,null,1,4,null,2,2,null,null],[3,13,2,40,13,59,580,44,null,10,null,null,null,null,null,39,15,null,null,23,20,21,50,30,26],[309,1384,154,1009,496,723,1232,878,42,719,2357,821,2395,1653,12492,350,170,820,85,1637,1289,2491,1565,1745,3625],[140,696,204,353,1301,314,1436,737,16,848,1143,761,974,533,6385,384,202,224,9,677,707,293,469,300,596],[247,785,154,646,514,453,277,858,92,682,1098,942,680,507,3766,399,257,88,38,483,152,341,196,183,326],[127,276,78,218,163,387,208,233,26,221,368,307,363,280,1954,97,54,139,44,265,469,347,145,294,271],[21,110,15,73,24,54,14,12,16,20,180,155,120,74,404,4,18,6,12,90,31,106,16,18,94],[12,42,6,30,12,23,14,35,6,24,76,20,27,33,237,9,8,24,4,10,77,61,128,82,57],[1,23,null,15,11,15,7,3,null,31,20,21,167,40,542,1,1,null,null,21,2,6,2,1,1],[1,7,null,4,1,2,10,9,2,1,11,2,3,1,88,null,null,1,3,2,null,4,10,6,3],[1,9,null,17,3,5,1,7,null,4,10,7,15,20,90,1,2,6,null,4,5,15,67,2,10],[null,1,null,4,3,null,1,null,null,null,7,1,2,1,8,null,null,2,null,null,2,13,2,4,2],[null,1,null,2,null,null,null,null,null,null,2,null,3,2,7,1,null,null,null,2,null,null,1,null,null],[null,null,null,null,null,null,null,null,null,null,1,null,null,null,6,null,null,4,null,1,null,null,null,null,null],[null,null,null,9,null,null,1,null,null,null,1,2,null,11,36,null,null,null,null,null,14,15,8,8,15],[8,49,11,30,36,24,48,42,7,37,95,34,114,64,364,16,6,null,6,63,24,24,10,11,39],[94,438,98,281,343,229,603,403,25,302,767,368,984,486,3848,183,95,null,24,536,150,246,113,164,342],[156,632,103,371,439,380,690,501,36,432,967,527,1003,621,4752,169,112,null,39,665,223,362,176,153,359],[144,574,105,418,464,348,529,452,27,394,964,559,852,541,4598,187,116,null,37,577,302,378,195,154,331],[124,502,89,387,394,299,371,412,23,409,735,413,575,450,3794,170,107,null,26,441,295,347,182,116,289],[115,372,75,299,308,226,274,324,22,332,613,396,442,346,2951,154,89,null,22,308,304,297,149,83,220],[86,298,51,234,242,168,250,236,16,233,484,276,322,277,2222,132,64,null,20,210,195,230,117,61,158],[91,330,54,252,216,211,299,289,25,306,468,320,332,293,2511,152,81,null,16,285,211,300,108,98,221],[41,140,24,112,97,89,135,113,19,109,180,148,130,85,984,83,42,null,5,107,83,99,52,20,94]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Departamento<\/th>\n      <th>Poblacion<\/th>\n      <th>Numero.de.establecimientos.penitenciarios<\/th>\n      <th>Sexo_F<\/th>\n      <th>Sexo_M<\/th>\n      <th>Sin.nivel<\/th>\n      <th>Educacion.inicial<\/th>\n      <th>Primaria.completa<\/th>\n      <th>Primaria.incompleta<\/th>\n      <th>Secund..completa<\/th>\n      <th>Secund..incompleta<\/th>\n      <th>Sup..no.universitaria.completa<\/th>\n      <th>Sup..no.universitaria.incompleta<\/th>\n      <th>Sup..universitaria.completa<\/th>\n      <th>Sup..universitaria.incompleta<\/th>\n      <th>Postgrado<\/th>\n      <th>no.aplica<\/th>\n      <th>Delitos.contra.el.patrimonio<\/th>\n      <th>Delitos.contra.la.seguridad.publica<\/th>\n      <th>Delitos.contra.la.libertad<\/th>\n      <th>Delitos.contra.la.vida..el.cuerpo.y.la.salud<\/th>\n      <th>Delitos.contra.la.familia<\/th>\n      <th>Delitos.contra.la.administracion.publica<\/th>\n      <th>Delitos.contra.la.tranquilidad.publica<\/th>\n      <th>Delitos.contra.el.orden.fi.nciero.y.monetario<\/th>\n      <th>Delitos.contra.la.fe.publica<\/th>\n      <th>Delitos.tributarios<\/th>\n      <th>Delitos.contra.la.confianza.y.la.bue..fe.en.los.negocios<\/th>\n      <th>Delitos.contra.la.humanidad<\/th>\n      <th>OTROS.1.<\/th>\n      <th>Edad.18.19<\/th>\n      <th>Edad.20.24<\/th>\n      <th>Edad.25.29<\/th>\n      <th>Edad.30.34<\/th>\n      <th>Edad.35.39<\/th>\n      <th>Edad.40.44<\/th>\n      <th>Edad.45.49<\/th>\n      <th>Edad.50.59<\/th>\n      <th>Edad.60.a.mas<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="proceso-de-análisis-de-los-datos.html#cb2-1"></a><span class="co"># saveRDS(data0, file = &quot;data0RDS.RDS&quot;)</span></span></code></pre></div>
<p>Primeramente reducimos el nombre de nuestras variables paara una mejor visualización</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="proceso-de-análisis-de-los-datos.html#cb3-1"></a><span class="kw">names</span>(data0) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Dep&quot;</span>,<span class="st">&quot;Pob&quot;</span>,<span class="st">&quot;NEP&quot;</span>,</span>
<span id="cb3-2"><a href="proceso-de-análisis-de-los-datos.html#cb3-2"></a>                  <span class="st">&quot;S_F&quot;</span>,<span class="st">&quot;S_M&quot;</span>,<span class="st">&quot;SNE&quot;</span>,</span>
<span id="cb3-3"><a href="proceso-de-análisis-de-los-datos.html#cb3-3"></a>                  <span class="st">&quot;NE_I&quot;</span>,<span class="st">&quot;NE_PC&quot;</span>,<span class="st">&quot;ND_PI&quot;</span>,</span>
<span id="cb3-4"><a href="proceso-de-análisis-de-los-datos.html#cb3-4"></a>                  <span class="st">&quot;NE_SC&quot;</span>,<span class="st">&quot;NE_SI&quot;</span>,<span class="st">&quot;NE_SnUC&quot;</span>,</span>
<span id="cb3-5"><a href="proceso-de-análisis-de-los-datos.html#cb3-5"></a>                  <span class="st">&quot;NE_SnUI&quot;</span>,<span class="st">&quot;NE_SUC&quot;</span>,<span class="st">&quot;NE_SUI&quot;</span>,</span>
<span id="cb3-6"><a href="proceso-de-análisis-de-los-datos.html#cb3-6"></a>                  <span class="st">&quot;NE_Pstgr&quot;</span>,<span class="st">&quot;NE_NAp&quot;</span>,<span class="st">&quot;DcP&quot;</span>,</span>
<span id="cb3-7"><a href="proceso-de-análisis-de-los-datos.html#cb3-7"></a>                  <span class="st">&quot;DcSegP&quot;</span>,<span class="st">&quot;DcL&quot;</span>,<span class="st">&quot;DcVCS&quot;</span>,</span>
<span id="cb3-8"><a href="proceso-de-análisis-de-los-datos.html#cb3-8"></a>                  <span class="st">&quot;DcF&quot;</span>,<span class="st">&quot;DcAP&quot;</span>,<span class="st">&quot;DcTP&quot;</span>,</span>
<span id="cb3-9"><a href="proceso-de-análisis-de-los-datos.html#cb3-9"></a>                  <span class="st">&quot;DcOFM&quot;</span>,<span class="st">&quot;DcFP&quot;</span>,<span class="st">&quot;Dt&quot;</span>,</span>
<span id="cb3-10"><a href="proceso-de-análisis-de-los-datos.html#cb3-10"></a>                  <span class="st">&quot;DcCBFN&quot;</span>,<span class="st">&quot;DcH&quot;</span>,<span class="st">&quot;Otros&quot;</span>,</span>
<span id="cb3-11"><a href="proceso-de-análisis-de-los-datos.html#cb3-11"></a>                  <span class="st">&quot;E_18_19&quot;</span>,<span class="st">&quot;E_20_24&quot;</span>,<span class="st">&quot;E_25_29&quot;</span>,</span>
<span id="cb3-12"><a href="proceso-de-análisis-de-los-datos.html#cb3-12"></a>                  <span class="st">&quot;E_30_34&quot;</span>,<span class="st">&quot;E_35_39&quot;</span>,<span class="st">&quot;E_40_44&quot;</span>,</span>
<span id="cb3-13"><a href="proceso-de-análisis-de-los-datos.html#cb3-13"></a>                  <span class="st">&quot;E_45_49&quot;</span>,<span class="st">&quot;E_50_59&quot;</span>,<span class="st">&quot;E_60_&quot;</span>)</span>
<span id="cb3-14"><a href="proceso-de-análisis-de-los-datos.html#cb3-14"></a></span>
<span id="cb3-15"><a href="proceso-de-análisis-de-los-datos.html#cb3-15"></a><span class="co">#View(data0)</span></span>
<span id="cb3-16"><a href="proceso-de-análisis-de-los-datos.html#cb3-16"></a><span class="kw">tibble</span>(data0)</span></code></pre></div>
<pre><code>## # A tibble: 25 x 39
##    Dep         Pob   NEP   S_F   S_M   SNE  NE_I NE_PC ND_PI NE_SC NE_SI NE_SnUC
##    &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
##  1 AMAZONAS 3.79e5     2    35   824    35     3   139   265   165   184      24
##  2 ANCASH   1.08e6     2   156  3179     3     3   316   529   834  1164     125
##  3 APURIMAC 4.06e5     2    61   549    21    NA    65   128   166   168      15
##  4 AREQUIPA 1.38e6     3   158  2226    48    NA   167   310   693   659     159
##  5 AYACUCHO 6.16e5     2   192  2347    89     5   284   527   638   733      88
##  6 CAJAMAR~ 1.34e6     4   107  1867   110     3   341   441   416   399      70
##  7 CALLAO   9.94e5     1    NA  3199    16     4   196   227   869   990     102
##  8 CUSCO    1.21e6     3   186  2586    70     3   230   530   801   727      91
##  9 HUANCAV~ 3.48e5     1     9   191     3    NA    22    39    54    42      17
## 10 HUANUCO  7.21e5     1   162  2392   145     8   290   643   564   650      57
## # ... with 15 more rows, and 27 more variables: NE_SnUI &lt;int&gt;, NE_SUC &lt;int&gt;,
## #   NE_SUI &lt;int&gt;, NE_Pstgr &lt;int&gt;, NE_NAp &lt;int&gt;, DcP &lt;int&gt;, DcSegP &lt;int&gt;,
## #   DcL &lt;int&gt;, DcVCS &lt;int&gt;, DcF &lt;int&gt;, DcAP &lt;int&gt;, DcTP &lt;int&gt;, DcOFM &lt;int&gt;,
## #   DcFP &lt;int&gt;, Dt &lt;int&gt;, DcCBFN &lt;int&gt;, DcH &lt;int&gt;, Otros &lt;int&gt;, E_18_19 &lt;int&gt;,
## #   E_20_24 &lt;int&gt;, E_25_29 &lt;int&gt;, E_30_34 &lt;int&gt;, E_35_39 &lt;int&gt;, E_40_44 &lt;int&gt;,
## #   E_45_49 &lt;int&gt;, E_50_59 &lt;int&gt;, E_60_ &lt;int&gt;</code></pre>
</div>
<div id="eliminar-na" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Eliminar NA</h3>
<p>Se evalua los Missing Values en la data ya que no deben ser el mayor porcentaje del total.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="proceso-de-análisis-de-los-datos.html#cb5-1"></a>data0 <span class="op">%&gt;%</span><span class="st"> </span>mice<span class="op">::</span><span class="kw">md.pattern</span>(<span class="dt">rotate.names=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre><code>##   Dep Pob NEP DcP DcSegP DcL DcVCS DcF DcAP S_M SNE NE_PC ND_PI NE_SC NE_SI
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 2   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 2   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 2   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 2   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   1   1     1     1     1     1
## 1   1   1   1   1      1   1     1   1    1   0   0     0     0     0     0
##     0   0   0   0      0   0     0   0    0   1   1     1     1     1     1
##   NE_SnUC NE_SnUI NE_SUC NE_SUI E_18_19 E_20_24 E_25_29 E_30_34 E_35_39 E_40_44
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 2       1       1      1      1       1       1       1       1       1       1
## 2       1       1      1      1       1       1       1       1       1       1
## 2       1       1      1      1       1       1       1       1       1       1
## 2       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       1       1      1      1       1       1       1       1       1       1
## 1       0       0      0      0       0       0       0       0       0       0
##         1       1      1      1       1       1       1       1       1       1
##   E_45_49 E_50_59 E_60_ S_F DcFP NE_I DcTP DcOFM NE_NAp NE_Pstgr Dt Otros
## 1       1       1     1   1    1    1    1     1      1        1  1     1
## 1       1       1     1   1    1    1    1     1      1        1  1     1
## 1       1       1     1   1    1    1    1     1      1        1  1     0
## 1       1       1     1   1    1    1    1     1      1        1  1     0
## 1       1       1     1   1    1    1    1     1      1        1  0     0
## 2       1       1     1   1    1    1    1     1      1        1  0     0
## 2       1       1     1   1    1    1    1     1      1        0  1     1
## 2       1       1     1   1    1    1    1     1      1        0  0     0
## 2       1       1     1   1    1    1    1     1      0        1  1     1
## 1       1       1     1   1    1    1    1     1      0        1  1     1
## 1       1       1     1   1    1    1    1     1      0        1  1     0
## 1       1       1     1   1    1    1    1     1      0        0  1     1
## 1       1       1     1   1    1    1    1     0      1        1  0     0
## 1       1       1     1   1    1    1    1     0      1        0  1     1
## 1       1       1     1   1    1    0    1     1      1        1  1     1
## 1       1       1     1   1    0    1    0     1      0        1  0     0
## 1       1       1     1   1    0    0    0     1      0        1  0     0
## 1       1       1     1   1    0    0    0     0      1        0  0     0
## 1       1       1     1   0    1    1    1     1      1        1  1     1
## 1       1       1     1   0    1    1    1     0      1        0  0     0
## 1       0       0     0   0    1    0    0     1      0        0  1     0
##         1       1     1   3    3    4    4     4      8        9 10    14
##   DcCBFN DcH    
## 1      1   0   1
## 1      0   0   2
## 1      1   0   2
## 1      0   0   3
## 1      1   1   2
## 2      0   0   4
## 2      0   0   3
## 2      0   0   5
## 2      1   1   1
## 1      1   0   2
## 1      1   0   3
## 1      0   0   4
## 1      1   0   4
## 1      0   0   4
## 1      1   0   2
## 1      0   0   7
## 1      0   0   8
## 1      0   0   9
## 1      0   0   3
## 1      0   0   7
## 1      0   1  26
##       16  21 115</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="proceso-de-análisis-de-los-datos.html#cb7-1"></a><span class="co">#data0 %&gt;% VIM::aggr(numbers=T, sortVar=T )</span></span></code></pre></div>
<p>Observando el grafico, se entiende que para la primera fila hay una observacion que tiene NA en la variable DcH en la segunda fila,hay una observacion que tiene NA en DcBFN y DcH, así sucesivamente hasta llegar a la ultima fila, donde una observacion tiene 26 NA, el cual definitivamente se eliminara.</p>
</div>
<div id="eliminar-filas" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Eliminar filas</h3>
<p>Las variables principales que son sustento base de que existen los datos y son reales, vienen a ser cinco, la variable poblacion, establecimientos penitenciarios, mujeres y varones, es por ello que si alguno no tiene datos, procedera a ser eliminado</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="proceso-de-análisis-de-los-datos.html#cb8-1"></a>data0 &lt;-<span class="st"> </span>data0[<span class="op">!</span><span class="kw">is.na</span>(data0<span class="op">$</span>Pob),]</span>
<span id="cb8-2"><a href="proceso-de-análisis-de-los-datos.html#cb8-2"></a>data0 &lt;-<span class="st"> </span>data0[<span class="op">!</span><span class="kw">is.na</span>(data0<span class="op">$</span>NEP),]</span>
<span id="cb8-3"><a href="proceso-de-análisis-de-los-datos.html#cb8-3"></a>data0 &lt;-<span class="st"> </span>data0[<span class="op">!</span><span class="kw">is.na</span>(data0<span class="op">$</span>S_F),]</span>
<span id="cb8-4"><a href="proceso-de-análisis-de-los-datos.html#cb8-4"></a>data0 &lt;-<span class="st"> </span>data0[<span class="op">!</span><span class="kw">is.na</span>(data0<span class="op">$</span>S_M),]</span>
<span id="cb8-5"><a href="proceso-de-análisis-de-los-datos.html#cb8-5"></a></span>
<span id="cb8-6"><a href="proceso-de-análisis-de-los-datos.html#cb8-6"></a><span class="kw">tibble</span>(data0) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="dv">26</span>)</span></code></pre></div>
<pre><code>## # A tibble: 22 x 39
##    Dep         Pob   NEP   S_F   S_M   SNE  NE_I NE_PC ND_PI NE_SC NE_SI NE_SnUC
##    &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
##  1 &quot;AMAZON~ 3.79e5     2    35   824    35     3   139   265   165   184      24
##  2 &quot;ANCASH&quot; 1.08e6     2   156  3179     3     3   316   529   834  1164     125
##  3 &quot;APURIM~ 4.06e5     2    61   549    21    NA    65   128   166   168      15
##  4 &quot;AREQUI~ 1.38e6     3   158  2226    48    NA   167   310   693   659     159
##  5 &quot;AYACUC~ 6.16e5     2   192  2347    89     5   284   527   638   733      88
##  6 &quot;CAJAMA~ 1.34e6     4   107  1867   110     3   341   441   416   399      70
##  7 &quot;CUSCO&quot;  1.21e6     3   186  2586    70     3   230   530   801   727      91
##  8 &quot;HUANCA~ 3.48e5     1     9   191     3    NA    22    39    54    42      17
##  9 &quot;HUANUC~ 7.21e5     1   162  2392   145     8   290   643   564   650      57
## 10 &quot;ICA&quot;    8.51e5     2   302  4971    72     3   312   578  1665  1831     236
## 11 &quot;JUNIN&quot;  1.25e6     7   180  2861    84    14   320   613   803   840      90
## 12 &quot;LA LIB~ 1.78e6     2   283  4471   124     9   589   905  1084  1518     154
## 13 &quot;LAMBAY~ 1.20e6     1   163  3000    94     5   373   548   791   999     103
## 14 &quot;LIMA&quot;   1.78e7    10  1884 24140   281    29  1740  2873  7452  9391     979
## 15 &quot;LORETO&quot; 3.69e7     3    74  1172    53     1   136   259   285   351      36
## 16 &quot;PASCO&quot;  2.53e6     2    14   181     4     1    10    26    81    39       6
## 17 &quot;PIURA&quot;  3.59e6     1    94  3098    84     1   310   619   805  1000     123
## 18 &quot;PUNO&quot;   1.17e6     3   190  1597    37     2   200   298   556   403      66
## 19 &quot;SAN MA~ 8.13e5     4    62  2221    92     6   422   564   398   560      86
## 20 &quot;TACNA &quot; 3.29e5     3   110   992    24     2    75   156   314   335      45
## 21 &quot;TUMBES&quot; 2.25e5     1    37   823    27    83   156   201   297    23      21
## 22 &quot;UCAYAL~ 4.96e5     1   104  1949    65     1   207   413   456   690      60
## # ... with 27 more variables: NE_SnUI &lt;int&gt;, NE_SUC &lt;int&gt;, NE_SUI &lt;int&gt;,
## #   NE_Pstgr &lt;int&gt;, NE_NAp &lt;int&gt;, DcP &lt;int&gt;, DcSegP &lt;int&gt;, DcL &lt;int&gt;,
## #   DcVCS &lt;int&gt;, DcF &lt;int&gt;, DcAP &lt;int&gt;, DcTP &lt;int&gt;, DcOFM &lt;int&gt;, DcFP &lt;int&gt;,
## #   Dt &lt;int&gt;, DcCBFN &lt;int&gt;, DcH &lt;int&gt;, Otros &lt;int&gt;, E_18_19 &lt;int&gt;,
## #   E_20_24 &lt;int&gt;, E_25_29 &lt;int&gt;, E_30_34 &lt;int&gt;, E_35_39 &lt;int&gt;, E_40_44 &lt;int&gt;,
## #   E_45_49 &lt;int&gt;, E_50_59 &lt;int&gt;, E_60_ &lt;int&gt;</code></pre>
<p>Como se observa, la cantidad de departamentos se redujo, se elimino al Callao, Moquegua y Madre de Dios</p>
</div>
<div id="eliminar-columnas" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Eliminar columnas</h3>
<p>Teniendo todos los departamentos con la data principal, se procede a analizar las varibles, teniendo en cuenta que no podemos trabajar con NA,se procedera a eliminar aquellas columnas que la contengan.</p>
<p>Examinamos cuantos NA tiene cada columna para darnos una idea</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="proceso-de-análisis-de-los-datos.html#cb10-1"></a><span class="kw">sapply</span>(data0, <span class="cf">function</span>(x) <span class="kw">sum</span>(<span class="kw">is.na</span>(x))) <span class="co">#numero de nulos por columnas</span></span></code></pre></div>
<pre><code>##      Dep      Pob      NEP      S_F      S_M      SNE     NE_I    NE_PC 
##        0        0        0        0        0        0        3        0 
##    ND_PI    NE_SC    NE_SI  NE_SnUC  NE_SnUI   NE_SUC   NE_SUI NE_Pstgr 
##        0        0        0        0        0        0        0        7 
##   NE_NAp      DcP   DcSegP      DcL    DcVCS      DcF     DcAP     DcTP 
##        7        0        0        0        0        0        0        3 
##    DcOFM     DcFP       Dt   DcCBFN      DcH    Otros  E_18_19  E_20_24 
##        3        3        9       13       19       12        0        0 
##  E_25_29  E_30_34  E_35_39  E_40_44  E_45_49  E_50_59    E_60_ 
##        0        0        0        0        0        0        0</code></pre>
<p>Eliminamos todas las columnas que tienen al menos un NA</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="proceso-de-análisis-de-los-datos.html#cb12-1"></a><span class="kw">colMeans</span>(<span class="kw">is.na</span>(data0))</span></code></pre></div>
<pre><code>##       Dep       Pob       NEP       S_F       S_M       SNE      NE_I     NE_PC 
## 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.1363636 0.0000000 
##     ND_PI     NE_SC     NE_SI   NE_SnUC   NE_SnUI    NE_SUC    NE_SUI  NE_Pstgr 
## 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.3181818 
##    NE_NAp       DcP    DcSegP       DcL     DcVCS       DcF      DcAP      DcTP 
## 0.3181818 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.1363636 
##     DcOFM      DcFP        Dt    DcCBFN       DcH     Otros   E_18_19   E_20_24 
## 0.1363636 0.1363636 0.4090909 0.5909091 0.8636364 0.5454545 0.0000000 0.0000000 
##   E_25_29   E_30_34   E_35_39   E_40_44   E_45_49   E_50_59     E_60_ 
## 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="proceso-de-análisis-de-los-datos.html#cb14-1"></a>data1 &lt;-<span class="st"> </span>data0[,<span class="op">-</span><span class="kw">which</span>(<span class="kw">colMeans</span>(<span class="kw">is.na</span>(data0)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)]</span>
<span id="cb14-2"><a href="proceso-de-análisis-de-los-datos.html#cb14-2"></a><span class="kw">tibble</span>(data1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">n=</span><span class="dv">26</span>)</span></code></pre></div>
<pre><code>## # A tibble: 22 x 29
##    Dep       Pob   NEP   S_F   S_M   SNE NE_PC ND_PI NE_SC NE_SI NE_SnUC NE_SnUI
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;   &lt;int&gt;
##  1 &quot;AMAZ~ 3.79e5     2    35   824    35   139   265   165   184      24      16
##  2 &quot;ANCA~ 1.08e6     2   156  3179     3   316   529   834  1164     125      87
##  3 &quot;APUR~ 4.06e5     2    61   549    21    65   128   166   168      15      13
##  4 &quot;AREQ~ 1.38e6     3   158  2226    48   167   310   693   659     159     127
##  5 &quot;AYAC~ 6.16e5     2   192  2347    89   284   527   638   733      88      62
##  6 &quot;CAJA~ 1.34e6     4   107  1867   110   341   441   416   399      70      44
##  7 &quot;CUSC~ 1.21e6     3   186  2586    70   230   530   801   727      91     102
##  8 &quot;HUAN~ 3.48e5     1     9   191     3    22    39    54    42      17       6
##  9 &quot;HUAN~ 7.21e5     1   162  2392   145   290   643   564   650      57      59
## 10 &quot;ICA&quot;  8.51e5     2   302  4971    72   312   578  1665  1831     236     233
## 11 &quot;JUNI~ 1.25e6     7   180  2861    84   320   613   803   840      90      78
## 12 &quot;LA L~ 1.78e6     2   283  4471   124   589   905  1084  1518     154     159
## 13 &quot;LAMB~ 1.20e6     1   163  3000    94   373   548   791   999     103      94
## 14 &quot;LIMA&quot; 1.78e7    10  1884 24140   281  1740  2873  7452  9391     979     962
## 15 &quot;LORE~ 3.69e7     3    74  1172    53   136   259   285   351      36      38
## 16 &quot;PASC~ 2.53e6     2    14   181     4    10    26    81    39       6       5
## 17 &quot;PIUR~ 3.59e6     1    94  3098    84   310   619   805  1000     123     134
## 18 &quot;PUNO&quot; 1.17e6     3   190  1597    37   200   298   556   403      66      51
## 19 &quot;SAN ~ 8.13e5     4    62  2221    92   422   564   398   560      86      52
## 20 &quot;TACN~ 3.29e5     3   110   992    24    75   156   314   335      45      35
## 21 &quot;TUMB~ 2.25e5     1    37   823    27   156   201   297    23      21      11
## 22 &quot;UCAY~ 4.96e5     1   104  1949    65   207   413   456   690      60      73
## # ... with 17 more variables: NE_SUC &lt;int&gt;, NE_SUI &lt;int&gt;, DcP &lt;int&gt;,
## #   DcSegP &lt;int&gt;, DcL &lt;int&gt;, DcVCS &lt;int&gt;, DcF &lt;int&gt;, DcAP &lt;int&gt;, E_18_19 &lt;int&gt;,
## #   E_20_24 &lt;int&gt;, E_25_29 &lt;int&gt;, E_30_34 &lt;int&gt;, E_35_39 &lt;int&gt;, E_40_44 &lt;int&gt;,
## #   E_45_49 &lt;int&gt;, E_50_59 &lt;int&gt;, E_60_ &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="proceso-de-análisis-de-los-datos.html#cb16-1"></a><span class="co">#View(data1)</span></span></code></pre></div>
<p>De 39 variables se eliminaron 10. Ahora verificamos que nuestra data no tenga NA</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="proceso-de-análisis-de-los-datos.html#cb17-1"></a>data1 <span class="op">%&gt;%</span><span class="st"> </span>mice<span class="op">::</span><span class="kw">md.pattern</span>(<span class="dt">rotate.names=</span><span class="ot">TRUE</span>) <span class="co">#verificando que no hay NA</span></span></code></pre></div>
<pre><code>##  /\     /\
## {  `---&#39;  }
## {  O   O  }
## ==&gt;  V &lt;==  No need for mice. This data set is completely observed.
##  \  \|/  /
##   `-----&#39;</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>##    Dep Pob NEP S_F S_M SNE NE_PC ND_PI NE_SC NE_SI NE_SnUC NE_SnUI NE_SUC
## 22   1   1   1   1   1   1     1     1     1     1       1       1      1
##      0   0   0   0   0   0     0     0     0     0       0       0      0
##    NE_SUI DcP DcSegP DcL DcVCS DcF DcAP E_18_19 E_20_24 E_25_29 E_30_34 E_35_39
## 22      1   1      1   1     1   1    1       1       1       1       1       1
##         0   0      0   0     0   0    0       0       0       0       0       0
##    E_40_44 E_45_49 E_50_59 E_60_  
## 22       1       1       1     1 0
##          0       0       0     0 0</code></pre>
</div>
<div id="gráfico-resumen" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Gráfico resumen</h3>
<p>Mostramos porcentaje de Delitos en todo el Perú, después de la limpieza de datos.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="proceso-de-análisis-de-los-datos.html#cb20-1"></a><span class="co">#glimpse(data1)</span></span>
<span id="cb20-2"><a href="proceso-de-análisis-de-los-datos.html#cb20-2"></a>total &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(data1,<span class="dv">15</span><span class="op">:</span><span class="dv">20</span>)</span>
<span id="cb20-3"><a href="proceso-de-análisis-de-los-datos.html#cb20-3"></a>suma &lt;-<span class="st"> </span><span class="kw">colSums</span> (total)</span>
<span id="cb20-4"><a href="proceso-de-análisis-de-los-datos.html#cb20-4"></a>porcent &lt;-<span class="st"> </span><span class="kw">cbind</span>(suma,<span class="dt">prop =</span> <span class="kw">prop.table</span>(suma))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb20-5"><a href="proceso-de-análisis-de-los-datos.html#cb20-5"></a>grafico &lt;-<span class="st"> </span><span class="kw">data.frame</span>(porcent)</span>
<span id="cb20-6"><a href="proceso-de-análisis-de-los-datos.html#cb20-6"></a>grafico</span></code></pre></div>
<pre><code>##           suma      prop
## DcP    3821900 48.259969
## DcSegP 1784000 22.526959
## DcL    1354200 17.099780
## DcVCS   693300  8.754451
## DcF     164900  2.082228
## DcAP    101100  1.276612</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="proceso-de-análisis-de-los-datos.html#cb22-1"></a>etiquetas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;48.25% DcP&quot;</span>,<span class="st">&quot;22.52% DcSegP&quot;</span>,<span class="st">&quot;17.09% DcL&quot;</span>,<span class="st">&quot;8.75% DcVCS&quot;</span>,<span class="st">&quot;2.08% DcF&quot;</span>,<span class="st">&quot;1.27% DcAP&quot;</span>)</span>
<span id="cb22-2"><a href="proceso-de-análisis-de-los-datos.html#cb22-2"></a></span>
<span id="cb22-3"><a href="proceso-de-análisis-de-los-datos.html#cb22-3"></a><span class="kw">pie</span>(grafico<span class="op">$</span>prop , <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="kw">length</span>(grafico<span class="op">$</span>prop)), </span>
<span id="cb22-4"><a href="proceso-de-análisis-de-los-datos.html#cb22-4"></a>    <span class="dt">labels =</span> etiquetas,</span>
<span id="cb22-5"><a href="proceso-de-análisis-de-los-datos.html#cb22-5"></a>    <span class="dt">main =</span> <span class="st">&quot;Delitos en Perú&quot;,</span></span>
<span id="cb22-6"><a href="proceso-de-análisis-de-los-datos.html#cb22-6"></a><span class="st">    sub = &quot;</span>Evaluación de la cantidad de delitos registrados por tipo.<span class="st">&quot;)</span></span>
<span id="cb22-7"><a href="proceso-de-análisis-de-los-datos.html#cb22-7"></a></span>
<span id="cb22-8"><a href="proceso-de-análisis-de-los-datos.html#cb22-8"></a><span class="st">legend(&quot;</span>topleft<span class="st">&quot;, </span></span>
<span id="cb22-9"><a href="proceso-de-análisis-de-los-datos.html#cb22-9"></a><span class="st">       c(&quot;</span>D. C. patrominio<span class="st">&quot;,</span></span>
<span id="cb22-10"><a href="proceso-de-análisis-de-los-datos.html#cb22-10"></a><span class="st">         &quot;</span>D. C. la seguridad publica<span class="st">&quot;,</span></span>
<span id="cb22-11"><a href="proceso-de-análisis-de-los-datos.html#cb22-11"></a><span class="st">         &quot;</span>D. C. la libertad<span class="st">&quot;,</span></span>
<span id="cb22-12"><a href="proceso-de-análisis-de-los-datos.html#cb22-12"></a><span class="st">         &quot;</span>D. C. la vida, el cuerpo y la salud<span class="st">&quot;,</span></span>
<span id="cb22-13"><a href="proceso-de-análisis-de-los-datos.html#cb22-13"></a><span class="st">         &quot;</span>D. C. la familia<span class="st">&quot;,</span></span>
<span id="cb22-14"><a href="proceso-de-análisis-de-los-datos.html#cb22-14"></a><span class="st">         &quot;</span>D. C. la administracion publica<span class="st">&quot;),</span></span>
<span id="cb22-15"><a href="proceso-de-análisis-de-los-datos.html#cb22-15"></a><span class="st">       cex = 0.5,</span></span>
<span id="cb22-16"><a href="proceso-de-análisis-de-los-datos.html#cb22-16"></a><span class="st">       fill = rainbow(length(grafico$prop)))</span></span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>En el grafico observamos que el Delito contra el patrimonio es el que mas se da a nivel Nacional, seguido por el Delito contra la seguridad publica, estos dos abarcan casi el 70% del total ya que van de la mano, la inseguridad en las calles genera robos, extorsion, etc</p>
<p>Mostramos porcentaje del nivel de educaciòn</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="proceso-de-análisis-de-los-datos.html#cb23-1"></a>educacion &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(data1,<span class="dv">6</span><span class="op">:</span><span class="dv">14</span>)</span>
<span id="cb23-2"><a href="proceso-de-análisis-de-los-datos.html#cb23-2"></a>tot &lt;-<span class="st"> </span><span class="kw">colSums</span>(educacion)</span>
<span id="cb23-3"><a href="proceso-de-análisis-de-los-datos.html#cb23-3"></a>perEDUC&lt;-<span class="st"> </span>(<span class="kw">cbind</span>(tot,<span class="dt">percent =</span> <span class="kw">prop.table</span>(tot))<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-4"><a href="proceso-de-análisis-de-los-datos.html#cb23-4"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">etiquet =</span> <span class="kw">c</span> (<span class="st">&quot;SNE&quot;</span>,</span>
<span id="cb23-5"><a href="proceso-de-análisis-de-los-datos.html#cb23-5"></a>                                          <span class="st">&quot;NE_PC&quot;</span>,</span>
<span id="cb23-6"><a href="proceso-de-análisis-de-los-datos.html#cb23-6"></a>                                          <span class="st">&quot;NE_PI&quot;</span>,</span>
<span id="cb23-7"><a href="proceso-de-análisis-de-los-datos.html#cb23-7"></a>                                          <span class="st">&quot;NE_SC&quot;</span>,</span>
<span id="cb23-8"><a href="proceso-de-análisis-de-los-datos.html#cb23-8"></a>                                          <span class="st">&quot;NE_SI&quot;</span>,</span>
<span id="cb23-9"><a href="proceso-de-análisis-de-los-datos.html#cb23-9"></a>                                          <span class="st">&quot;NE_SnUC&quot;</span>,</span>
<span id="cb23-10"><a href="proceso-de-análisis-de-los-datos.html#cb23-10"></a>                                          <span class="st">&quot;NE_SnIU&quot;</span>,</span>
<span id="cb23-11"><a href="proceso-de-análisis-de-los-datos.html#cb23-11"></a>                                          <span class="st">&quot;NE_SUC&quot;</span>,</span>
<span id="cb23-12"><a href="proceso-de-análisis-de-los-datos.html#cb23-12"></a>                                          <span class="st">&quot;NE_SUI&quot;</span>),</span>
<span id="cb23-13"><a href="proceso-de-análisis-de-los-datos.html#cb23-13"></a>                             <span class="dt">percent=</span><span class="kw">round</span>(percent,<span class="dv">2</span>),</span>
<span id="cb23-14"><a href="proceso-de-análisis-de-los-datos.html#cb23-14"></a>                             <span class="dt">total =</span> tot, </span>
<span id="cb23-15"><a href="proceso-de-análisis-de-los-datos.html#cb23-15"></a>                             <span class="dt">leyd =</span> <span class="kw">sprintf</span>(<span class="st">&quot;%1s( %1s)&quot;</span> ,etiquet, percent))</span>
<span id="cb23-16"><a href="proceso-de-análisis-de-los-datos.html#cb23-16"></a><span class="kw">pie</span>(perEDUC<span class="op">$</span>percent , <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="kw">length</span>(perEDUC<span class="op">$</span>percent)), </span>
<span id="cb23-17"><a href="proceso-de-análisis-de-los-datos.html#cb23-17"></a>    <span class="dt">labels =</span> perEDUC<span class="op">$</span>leyd,</span>
<span id="cb23-18"><a href="proceso-de-análisis-de-los-datos.html#cb23-18"></a>    <span class="dt">main =</span> <span class="st">&quot;Delitos en Perú segùn nivel de estudio&quot;</span>,</span>
<span id="cb23-19"><a href="proceso-de-análisis-de-los-datos.html#cb23-19"></a>    <span class="dt">sub =</span> <span class="st">&quot;Evaluación según nivel de estudio&quot;</span>)</span>
<span id="cb23-20"><a href="proceso-de-análisis-de-los-datos.html#cb23-20"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb23-21"><a href="proceso-de-análisis-de-los-datos.html#cb23-21"></a>       perEDUC<span class="op">$</span>etiquet,</span>
<span id="cb23-22"><a href="proceso-de-análisis-de-los-datos.html#cb23-22"></a>       <span class="dt">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb23-23"><a href="proceso-de-análisis-de-los-datos.html#cb23-23"></a>       <span class="dt">fill =</span> <span class="kw">rainbow</span>(<span class="kw">length</span>(perEDUC<span class="op">$</span>percent)))</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-9-1.png" width="672" />
En el grafico observamos que el nivel de estudio en el que se comete mas delitos son aquellas personas con secundaria incompleta (32.26%) , seguido de las personas con secundaria completa(27.45 %), mientras que el mas bajo son aquel grupo sin nivel de educaciòn.</p>
<p>Mostramos los datos segun rango de edad</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="proceso-de-análisis-de-los-datos.html#cb24-1"></a>edades &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(data1, <span class="dv">21</span><span class="op">:</span><span class="dv">29</span>)</span>
<span id="cb24-2"><a href="proceso-de-análisis-de-los-datos.html#cb24-2"></a>totale &lt;-<span class="st"> </span>edades <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">colSums</span>()</span>
<span id="cb24-3"><a href="proceso-de-análisis-de-los-datos.html#cb24-3"></a></span>
<span id="cb24-4"><a href="proceso-de-análisis-de-los-datos.html#cb24-4"></a>perEDAD&lt;-<span class="st"> </span>(<span class="kw">cbind</span>(totale,<span class="dt">percent =</span> <span class="kw">prop.table</span>(totale))<span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-5"><a href="proceso-de-análisis-de-los-datos.html#cb24-5"></a><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">etiquet =</span> <span class="kw">c</span> (<span class="st">&quot;E_18_19&quot;</span>,</span>
<span id="cb24-6"><a href="proceso-de-análisis-de-los-datos.html#cb24-6"></a>                                          <span class="st">&quot;E_20_24&quot;</span>,</span>
<span id="cb24-7"><a href="proceso-de-análisis-de-los-datos.html#cb24-7"></a>                                          <span class="st">&quot;E_25_29&quot;</span>,</span>
<span id="cb24-8"><a href="proceso-de-análisis-de-los-datos.html#cb24-8"></a>                                          <span class="st">&quot;E_30_34&quot;</span>,</span>
<span id="cb24-9"><a href="proceso-de-análisis-de-los-datos.html#cb24-9"></a>                                          <span class="st">&quot;E_35_39&quot;</span>,</span>
<span id="cb24-10"><a href="proceso-de-análisis-de-los-datos.html#cb24-10"></a>                                          <span class="st">&quot;E_40_44&quot;</span>,</span>
<span id="cb24-11"><a href="proceso-de-análisis-de-los-datos.html#cb24-11"></a>                                          <span class="st">&quot;E_45_49&quot;</span>,</span>
<span id="cb24-12"><a href="proceso-de-análisis-de-los-datos.html#cb24-12"></a>                                          <span class="st">&quot;E_50_59&quot;</span>,</span>
<span id="cb24-13"><a href="proceso-de-análisis-de-los-datos.html#cb24-13"></a>                                          <span class="st">&quot;E_60_&quot;</span>),</span>
<span id="cb24-14"><a href="proceso-de-análisis-de-los-datos.html#cb24-14"></a>                             <span class="dt">percent=</span><span class="kw">round</span>(percent,<span class="dv">2</span>),</span>
<span id="cb24-15"><a href="proceso-de-análisis-de-los-datos.html#cb24-15"></a>                             <span class="dt">total =</span> totale, </span>
<span id="cb24-16"><a href="proceso-de-análisis-de-los-datos.html#cb24-16"></a>                             <span class="dt">leyd =</span> <span class="kw">sprintf</span>(<span class="st">&quot;%1s( %1s)&quot;</span> ,etiquet, percent))</span>
<span id="cb24-17"><a href="proceso-de-análisis-de-los-datos.html#cb24-17"></a><span class="kw">pie</span>(perEDAD<span class="op">$</span>percent , <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="kw">length</span>(perEDAD<span class="op">$</span>percent)), </span>
<span id="cb24-18"><a href="proceso-de-análisis-de-los-datos.html#cb24-18"></a>    <span class="dt">labels =</span> perEDAD<span class="op">$</span>leyd,</span>
<span id="cb24-19"><a href="proceso-de-análisis-de-los-datos.html#cb24-19"></a>    <span class="dt">main =</span> <span class="st">&quot;Delitos en Perú segùn rango de edad&quot;</span>,</span>
<span id="cb24-20"><a href="proceso-de-análisis-de-los-datos.html#cb24-20"></a>    <span class="dt">sub =</span> <span class="st">&quot;Evaluación según rango de edad&quot;</span>)</span>
<span id="cb24-21"><a href="proceso-de-análisis-de-los-datos.html#cb24-21"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb24-22"><a href="proceso-de-análisis-de-los-datos.html#cb24-22"></a>       perEDAD<span class="op">$</span>etiquet,</span>
<span id="cb24-23"><a href="proceso-de-análisis-de-los-datos.html#cb24-23"></a>       <span class="dt">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-24"><a href="proceso-de-análisis-de-los-datos.html#cb24-24"></a>       <span class="dt">fill =</span> <span class="kw">rainbow</span>(<span class="kw">length</span>(perEDAD<span class="op">$</span>percent)))</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>En el grafico observamos que los rangos de edades en los que se comete màs delitos son los comprendidos entre 25 y 29 años con 18.83%, seguido de las edades comprendidas entre 30 y 34 años, mientras que el porcentaje mas bajo con 1.6% son el grupo comprendido entre los 18-19 años .</p>
</div>
<div id="anlizando-las-variables" class="section level3">
<h3><span class="header-section-number">5.1.6</span> Anlizando las variables</h3>
<p>Analizemos segun sexo</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="proceso-de-análisis-de-los-datos.html#cb25-1"></a>sexo &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(data1,<span class="dv">1</span>,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb25-2"><a href="proceso-de-análisis-de-los-datos.html#cb25-2"></a>ki&lt;-<span class="st"> </span><span class="kw">melt</span>(sexo)</span>
<span id="cb25-3"><a href="proceso-de-análisis-de-los-datos.html#cb25-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ki , <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Dep, <span class="dt">y=</span> value , <span class="dt">fill=</span> variable))<span class="op">+</span></span>
<span id="cb25-4"><a href="proceso-de-análisis-de-los-datos.html#cb25-4"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co"># el valor de la observacion es el de la barra</span></span>
<span id="cb25-5"><a href="proceso-de-análisis-de-los-datos.html#cb25-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Comparaciòn por sexo&quot;</span>,</span>
<span id="cb25-6"><a href="proceso-de-análisis-de-los-datos.html#cb25-6"></a>       <span class="dt">x =</span> <span class="st">&quot;Departamento&quot;</span>,</span>
<span id="cb25-7"><a href="proceso-de-análisis-de-los-datos.html#cb25-7"></a>       <span class="dt">y =</span> <span class="st">&quot;valor&quot;</span>)<span class="op">+</span></span>
<span id="cb25-8"><a href="proceso-de-análisis-de-los-datos.html#cb25-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">6</span>,<span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">vjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-11-1.png" width="672" />
En el gràfico podemos observar que el numero de varones es mucho mayor que las mujeres en todos los departamentos.</p>
<p>Tipo de delito</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="proceso-de-análisis-de-los-datos.html#cb26-1"></a>is_outlier &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb26-2"><a href="proceso-de-análisis-de-los-datos.html#cb26-2"></a>  <span class="kw">return</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(x, <span class="fl">0.25</span>) <span class="op">-</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">IQR</span>(x) <span class="op">|</span><span class="st"> </span>x <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(x, <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">IQR</span>(x))</span>
<span id="cb26-3"><a href="proceso-de-análisis-de-los-datos.html#cb26-3"></a>}</span>
<span id="cb26-4"><a href="proceso-de-análisis-de-los-datos.html#cb26-4"></a></span>
<span id="cb26-5"><a href="proceso-de-análisis-de-los-datos.html#cb26-5"></a>delit&lt;-<span class="st"> </span>data1 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">15</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-6"><a href="proceso-de-análisis-de-los-datos.html#cb26-6"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Dep, <span class="dt">names_to =</span> <span class="st">&quot;delitos&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Valor&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-7"><a href="proceso-de-análisis-de-los-datos.html#cb26-7"></a><span class="st">  </span><span class="kw">group_by</span>(delitos) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-8"><a href="proceso-de-análisis-de-los-datos.html#cb26-8"></a><span class="st">  </span><span class="kw">summarise</span>(delitos,Valor, Dep ,</span>
<span id="cb26-9"><a href="proceso-de-análisis-de-los-datos.html#cb26-9"></a>            <span class="dt">outlier =</span> <span class="kw">ifelse</span>(<span class="kw">is_outlier</span>(Valor), </span>
<span id="cb26-10"><a href="proceso-de-análisis-de-los-datos.html#cb26-10"></a>                             <span class="kw">sprintf</span>(<span class="st">&quot;%1s( %1s)&quot;</span> ,Valor, Dep), </span>
<span id="cb26-11"><a href="proceso-de-análisis-de-los-datos.html#cb26-11"></a>                             <span class="kw">as.numeric</span>(<span class="ot">NA</span>)))</span>
<span id="cb26-12"><a href="proceso-de-análisis-de-los-datos.html#cb26-12"></a><span class="kw">ggplot</span>(delit , <span class="dt">mapping =</span> <span class="kw">aes</span>( <span class="dt">x =</span> <span class="kw">factor</span>(delitos) , <span class="dt">y =</span> Valor , <span class="dt">fill =</span> delitos))<span class="op">+</span></span>
<span id="cb26-13"><a href="proceso-de-análisis-de-los-datos.html#cb26-13"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="co"># Error bars</span></span>
<span id="cb26-14"><a href="proceso-de-análisis-de-los-datos.html#cb26-14"></a>               <span class="dt">width =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st">    </span><span class="co"># Bars width</span></span>
<span id="cb26-15"><a href="proceso-de-análisis-de-los-datos.html#cb26-15"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>,          <span class="co"># Transparencia</span></span>
<span id="cb26-16"><a href="proceso-de-análisis-de-los-datos.html#cb26-16"></a>               <span class="dt">colour =</span> <span class="st">&quot;#474747&quot;</span>,   <span class="co"># Color del borde</span></span>
<span id="cb26-17"><a href="proceso-de-análisis-de-los-datos.html#cb26-17"></a>               <span class="dt">outlier.colour =</span> <span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb26-18"><a href="proceso-de-análisis-de-los-datos.html#cb26-18"></a><span class="st">  </span><span class="kw">ggtitle</span> (<span class="st">&quot;Evaluacion de delitos </span><span class="ch">\n</span><span class="st">Segun el tipo de delito&quot;</span>)<span class="op">+</span></span>
<span id="cb26-19"><a href="proceso-de-análisis-de-los-datos.html#cb26-19"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;beige&quot;</span>),</span>
<span id="cb26-20"><a href="proceso-de-análisis-de-los-datos.html#cb26-20"></a>        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Comic Sans MS&quot;</span>,</span>
<span id="cb26-21"><a href="proceso-de-análisis-de-los-datos.html#cb26-21"></a>                                  <span class="dt">size=</span><span class="kw">rel</span>(<span class="dv">2</span>), <span class="co">#Tamaño relativo de la letra del título</span></span>
<span id="cb26-22"><a href="proceso-de-análisis-de-los-datos.html#cb26-22"></a>                                  <span class="dt">vjust=</span><span class="dv">2</span>, <span class="co">#Justificación vertical, para separarlo del gráfico</span></span>
<span id="cb26-23"><a href="proceso-de-análisis-de-los-datos.html#cb26-23"></a>                                  <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="co">#Letra negrilla. Otras posibilidades &quot;plain&quot;, &quot;italic&quot;, &quot;bold&quot; y &quot;bold.italic&quot;</span></span>
<span id="cb26-24"><a href="proceso-de-análisis-de-los-datos.html#cb26-24"></a>                                  <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, <span class="co">#Color del texto</span></span>
<span id="cb26-25"><a href="proceso-de-análisis-de-los-datos.html#cb26-25"></a>                                  <span class="dt">lineheight=</span><span class="fl">1.5</span>))<span class="op">+</span></span>
<span id="cb26-26"><a href="proceso-de-análisis-de-los-datos.html#cb26-26"></a><span class="st">  </span><span class="kw">scale_fill_hue</span>(<span class="dt">labels =</span><span class="kw">c</span>(<span class="st">&quot;D. C. la administracion publica&quot;</span>,</span>
<span id="cb26-27"><a href="proceso-de-análisis-de-los-datos.html#cb26-27"></a>                           <span class="st">&quot;D. C. la familia&quot;</span>,</span>
<span id="cb26-28"><a href="proceso-de-análisis-de-los-datos.html#cb26-28"></a>                           <span class="st">&quot;D. C. la libertad&quot;</span>,</span>
<span id="cb26-29"><a href="proceso-de-análisis-de-los-datos.html#cb26-29"></a>                           <span class="st">&quot;D. C. patrominio&quot;</span>,</span>
<span id="cb26-30"><a href="proceso-de-análisis-de-los-datos.html#cb26-30"></a>                           <span class="st">&quot;D. C. la seguridad publica&quot;</span>,</span>
<span id="cb26-31"><a href="proceso-de-análisis-de-los-datos.html#cb26-31"></a>                           <span class="st">&quot;D. C. la vida, el cuerpo y la salud&quot;</span>))<span class="op">+</span></span>
<span id="cb26-32"><a href="proceso-de-análisis-de-los-datos.html#cb26-32"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> outlier), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">hjust =</span> <span class="fl">-0.3</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>En este grafico de cajas podemos observar que, la caja que representa al número de personas que cometen el delito contra el patrimonio (color celeste) es mayor que el de los otros delitos, a este tipo de delito le sigue el delito contra la familia y el delito contra la seguridad pública, la mediana se muestra en el centro, lo que indica que hay simetría en la distribución de número de personas, notamos también un valor atípico extremo muy alejado en la caja que representa al delito contra el patrimonio, lo que indicaría que en un momento dado, el número de personas que cometieron el delito contra el patrimonio supero los 12000, lo que nos indica que se trata de la provincia de Lima.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="proceso-de-análisis-de-los-datos.html#cb27-1"></a><span class="kw">ggplot</span>(delit, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Valor)) <span class="op">+</span></span>
<span id="cb27-2"><a href="proceso-de-análisis-de-los-datos.html#cb27-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>( <span class="kw">aes</span>(<span class="dt">fill =</span> delitos)) <span class="op">+</span></span>
<span id="cb27-3"><a href="proceso-de-análisis-de-los-datos.html#cb27-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribuciòn de delitos segùn tipo&quot;</span>,</span>
<span id="cb27-4"><a href="proceso-de-análisis-de-los-datos.html#cb27-4"></a>       <span class="dt">y =</span> <span class="st">&quot;Tipo de delito&quot;</span>) <span class="op">+</span></span>
<span id="cb27-5"><a href="proceso-de-análisis-de-los-datos.html#cb27-5"></a><span class="kw">facet_grid</span>(<span class="kw">vars</span>(delitos))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>En esta grafica podemos notar que el delito que presenta mayor distribución en número de veces que los cometen es el delito contra el patrimonio, que es el delito que atenta contra los bienes de una persona.
La distribución de los delitos contra la administración pública y delitos contra la familia se muestra como un delito cometido pocas veces.</p>
<p>Nivel de Educaciòn</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="proceso-de-análisis-de-los-datos.html#cb29-1"></a>educ&lt;-<span class="st"> </span>data1 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">6</span><span class="op">:</span><span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-2"><a href="proceso-de-análisis-de-los-datos.html#cb29-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Dep, <span class="dt">names_to =</span> <span class="st">&quot;N.educ&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Valor&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-3"><a href="proceso-de-análisis-de-los-datos.html#cb29-3"></a><span class="st">  </span><span class="kw">group_by</span>(N.educ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-4"><a href="proceso-de-análisis-de-los-datos.html#cb29-4"></a><span class="st">  </span><span class="kw">summarise</span>(N.educ,Valor, Dep , <span class="dt">outlier =</span> <span class="kw">ifelse</span>(<span class="kw">is_outlier</span>(Valor), </span>
<span id="cb29-5"><a href="proceso-de-análisis-de-los-datos.html#cb29-5"></a>                             <span class="kw">sprintf</span>(<span class="st">&quot;%1s( %1s)&quot;</span> ,Valor, Dep), </span>
<span id="cb29-6"><a href="proceso-de-análisis-de-los-datos.html#cb29-6"></a>                             <span class="kw">as.numeric</span>(<span class="ot">NA</span>)))</span>
<span id="cb29-7"><a href="proceso-de-análisis-de-los-datos.html#cb29-7"></a></span>
<span id="cb29-8"><a href="proceso-de-análisis-de-los-datos.html#cb29-8"></a><span class="kw">ggplot</span>( educ, <span class="dt">mapping =</span> <span class="kw">aes</span>( <span class="dt">x =</span> N.educ , <span class="dt">y =</span> Valor , <span class="dt">fill =</span> N.educ))<span class="op">+</span></span>
<span id="cb29-9"><a href="proceso-de-análisis-de-los-datos.html#cb29-9"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb29-10"><a href="proceso-de-análisis-de-los-datos.html#cb29-10"></a>               <span class="dt">width =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-11"><a href="proceso-de-análisis-de-los-datos.html#cb29-11"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>,          <span class="co"># Transparencia</span></span>
<span id="cb29-12"><a href="proceso-de-análisis-de-los-datos.html#cb29-12"></a>               <span class="dt">colour =</span> <span class="st">&quot;#474747&quot;</span>,   <span class="co"># Color del borde</span></span>
<span id="cb29-13"><a href="proceso-de-análisis-de-los-datos.html#cb29-13"></a>               <span class="dt">outlier.colour =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Color atípicos</span></span>
<span id="cb29-14"><a href="proceso-de-análisis-de-los-datos.html#cb29-14"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb29-15"><a href="proceso-de-análisis-de-los-datos.html#cb29-15"></a>    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;beige&quot;</span>)</span>
<span id="cb29-16"><a href="proceso-de-análisis-de-los-datos.html#cb29-16"></a>  )<span class="op">+</span><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> outlier), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">hjust =</span> <span class="fl">-0.3</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>En la gráfica podemos apreciar el nivel de educación de las personas que han cometido los distintos tipos de delitos, siendo el rango de las personas con secundaria incompleta (color verde) las que se han vistos involucrados en delitos más que en los demás niveles de educación, seguido de las personas con secundaria completa y personas con primaria incompleta.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="proceso-de-análisis-de-los-datos.html#cb30-1"></a><span class="kw">ggplot</span>(educ, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Valor)) <span class="op">+</span></span>
<span id="cb30-2"><a href="proceso-de-análisis-de-los-datos.html#cb30-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>( <span class="kw">aes</span>(<span class="dt">fill =</span> N.educ)) <span class="op">+</span></span>
<span id="cb30-3"><a href="proceso-de-análisis-de-los-datos.html#cb30-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribuciòn de delitos segùn nivel de educaciòn&quot;,</span></span>
<span id="cb30-4"><a href="proceso-de-análisis-de-los-datos.html#cb30-4"></a><span class="st">       y = &quot;</span>Nivel de educaciòn&quot;) <span class="op">+</span></span>
<span id="cb30-5"><a href="proceso-de-análisis-de-los-datos.html#cb30-5"></a><span class="kw">facet_grid</span>(<span class="kw">vars</span>(N.educ))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Podemos apreciar que la población que cuenta con un nivel educativo de secundaria incompleta tiene mayor distribución en cuanto a número de delitos cometidos, seguido de personas con un nivel educativo de secundaria completa y primaria incompleta.</p>
<p>Analicemos la edad</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="proceso-de-análisis-de-los-datos.html#cb32-1"></a>edad1 &lt;-data1 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">21</span><span class="op">:</span><span class="dv">29</span>) <span class="op">%&gt;%</span></span>
<span id="cb32-2"><a href="proceso-de-análisis-de-los-datos.html#cb32-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Dep, <span class="dt">names_to =</span> <span class="st">&quot;edad&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Valor&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="proceso-de-análisis-de-los-datos.html#cb32-3"></a><span class="st">  </span><span class="kw">group_by</span>(edad) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-4"><a href="proceso-de-análisis-de-los-datos.html#cb32-4"></a><span class="st">  </span><span class="kw">summarise</span>(edad,Valor, Dep, </span>
<span id="cb32-5"><a href="proceso-de-análisis-de-los-datos.html#cb32-5"></a>            <span class="dt">outlier =</span> <span class="kw">ifelse</span>(<span class="kw">is_outlier</span>(Valor), </span>
<span id="cb32-6"><a href="proceso-de-análisis-de-los-datos.html#cb32-6"></a>                             <span class="kw">sprintf</span>(<span class="st">&quot;%1s( %1s)&quot;</span> ,Valor, Dep), </span>
<span id="cb32-7"><a href="proceso-de-análisis-de-los-datos.html#cb32-7"></a>                             <span class="kw">as.numeric</span>(<span class="ot">NA</span>))) </span>
<span id="cb32-8"><a href="proceso-de-análisis-de-los-datos.html#cb32-8"></a></span>
<span id="cb32-9"><a href="proceso-de-análisis-de-los-datos.html#cb32-9"></a>  <span class="kw">ggplot</span>(edad1, <span class="dt">mapping =</span> <span class="kw">aes</span>( <span class="dt">x =</span> edad , <span class="dt">y =</span> Valor , <span class="dt">fill =</span> edad))<span class="op">+</span></span>
<span id="cb32-10"><a href="proceso-de-análisis-de-los-datos.html#cb32-10"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb32-11"><a href="proceso-de-análisis-de-los-datos.html#cb32-11"></a>               <span class="dt">width =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-12"><a href="proceso-de-análisis-de-los-datos.html#cb32-12"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>,          <span class="co"># Transparencia</span></span>
<span id="cb32-13"><a href="proceso-de-análisis-de-los-datos.html#cb32-13"></a>               <span class="dt">colour =</span> <span class="st">&quot;#474747&quot;</span>,   <span class="co"># Color del borde</span></span>
<span id="cb32-14"><a href="proceso-de-análisis-de-los-datos.html#cb32-14"></a>               <span class="dt">outlier.colour =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-15"><a href="proceso-de-análisis-de-los-datos.html#cb32-15"></a><span class="st">  </span><span class="kw">ggtitle</span> (<span class="st">&quot;Evaluacion de delitos </span><span class="ch">\n</span><span class="st">Segun grupo de edad&quot;</span>)<span class="op">+</span><span class="co"># Color atípicos</span></span>
<span id="cb32-16"><a href="proceso-de-análisis-de-los-datos.html#cb32-16"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb32-17"><a href="proceso-de-análisis-de-los-datos.html#cb32-17"></a>    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;beige&quot;</span>),</span>
<span id="cb32-18"><a href="proceso-de-análisis-de-los-datos.html#cb32-18"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Comic Sans MS&quot;</span>,</span>
<span id="cb32-19"><a href="proceso-de-análisis-de-los-datos.html#cb32-19"></a>                              <span class="dt">size=</span><span class="kw">rel</span>(<span class="dv">2</span>), <span class="co">#Tamaño relativo de la letra del título</span></span>
<span id="cb32-20"><a href="proceso-de-análisis-de-los-datos.html#cb32-20"></a>                              <span class="dt">vjust=</span><span class="dv">2</span>, <span class="co">#Justificación vertical, para separarlo del gráfico</span></span>
<span id="cb32-21"><a href="proceso-de-análisis-de-los-datos.html#cb32-21"></a>                              <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="co">#Letra negrilla. Otras posibilidades &quot;plain&quot;, &quot;italic&quot;, &quot;bold&quot; y &quot;bold.italic&quot;</span></span>
<span id="cb32-22"><a href="proceso-de-análisis-de-los-datos.html#cb32-22"></a>                              <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, <span class="co">#Color del texto</span></span>
<span id="cb32-23"><a href="proceso-de-análisis-de-los-datos.html#cb32-23"></a>                              <span class="dt">lineheight=</span><span class="fl">1.5</span>)</span>
<span id="cb32-24"><a href="proceso-de-análisis-de-los-datos.html#cb32-24"></a>  )<span class="op">+</span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> outlier), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">hjust =</span> <span class="fl">-0.3</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-16-1.png" width="672" />
En la gráfica se muestra el número de delitos cometidos y su relación con el grupo etario notando que el grupo que comete más delitos es el que se encuentra en el rango de 25 a 29 años, seguido de las personas que se encuentran entre los 30 a 34 años, y los que tienen de 20 a 24 años.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="proceso-de-análisis-de-los-datos.html#cb33-1"></a><span class="kw">ggplot</span>(edad1, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Valor)) <span class="op">+</span></span>
<span id="cb33-2"><a href="proceso-de-análisis-de-los-datos.html#cb33-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>( <span class="kw">aes</span>(<span class="dt">fill =</span> edad)) <span class="op">+</span></span>
<span id="cb33-3"><a href="proceso-de-análisis-de-los-datos.html#cb33-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribuciòn de delitos segùn grupo de edad&quot;</span>,</span>
<span id="cb33-4"><a href="proceso-de-análisis-de-los-datos.html#cb33-4"></a>       <span class="dt">y =</span> <span class="st">&quot;Grupo de edad&quot;</span>) <span class="op">+</span></span>
<span id="cb33-5"><a href="proceso-de-análisis-de-los-datos.html#cb33-5"></a><span class="kw">facet_grid</span>(<span class="kw">vars</span>(edad))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>La distribución de los delitos según el grupo etario nos permite corroborar lo dicho en el grafico anterior, el grupo que se encuentra entre los 30 a 34 años tienen datos distribuidos a lo largo del eje de números de delitos</p>
<p><strong>Analicemos la data sin Lima</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="proceso-de-análisis-de-los-datos.html#cb35-1"></a>data2 &lt;-<span class="st"> </span>data1[<span class="op">-</span><span class="dv">14</span>,]</span></code></pre></div>
<p>Tipos de delitos</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="proceso-de-análisis-de-los-datos.html#cb36-1"></a>delit2&lt;-<span class="st"> </span>data2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">15</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-2"><a href="proceso-de-análisis-de-los-datos.html#cb36-2"></a><span class="st">    </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Dep, <span class="dt">names_to =</span> <span class="st">&quot;delitos&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Valor&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-3"><a href="proceso-de-análisis-de-los-datos.html#cb36-3"></a><span class="st">  </span><span class="kw">group_by</span>(delitos) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-4"><a href="proceso-de-análisis-de-los-datos.html#cb36-4"></a><span class="st">  </span><span class="kw">summarise</span>(delitos,Valor, Dep)</span>
<span id="cb36-5"><a href="proceso-de-análisis-de-los-datos.html#cb36-5"></a><span class="kw">ggplot</span>(delit2 , <span class="dt">mapping =</span> <span class="kw">aes</span>( <span class="dt">x =</span> delitos , <span class="dt">y =</span> Valor , <span class="dt">fill =</span> delitos))<span class="op">+</span></span>
<span id="cb36-6"><a href="proceso-de-análisis-de-los-datos.html#cb36-6"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="co"># Error bars</span></span>
<span id="cb36-7"><a href="proceso-de-análisis-de-los-datos.html#cb36-7"></a>               <span class="dt">width =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st">    </span><span class="co"># Bars width</span></span>
<span id="cb36-8"><a href="proceso-de-análisis-de-los-datos.html#cb36-8"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>,          <span class="co"># Transparencia</span></span>
<span id="cb36-9"><a href="proceso-de-análisis-de-los-datos.html#cb36-9"></a>               <span class="dt">colour =</span> <span class="st">&quot;#474747&quot;</span>,   <span class="co"># Color del borde</span></span>
<span id="cb36-10"><a href="proceso-de-análisis-de-los-datos.html#cb36-10"></a>               <span class="dt">outlier.colour =</span> <span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb36-11"><a href="proceso-de-análisis-de-los-datos.html#cb36-11"></a><span class="st">  </span><span class="kw">ggtitle</span> (<span class="st">&quot;Evaluacion de delitos </span><span class="ch">\n</span><span class="st">Segun el tipo de delito&quot;</span>)<span class="op">+</span></span>
<span id="cb36-12"><a href="proceso-de-análisis-de-los-datos.html#cb36-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;beige&quot;</span>),</span>
<span id="cb36-13"><a href="proceso-de-análisis-de-los-datos.html#cb36-13"></a>        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Comic Sans MS&quot;</span>,</span>
<span id="cb36-14"><a href="proceso-de-análisis-de-los-datos.html#cb36-14"></a>                                  <span class="dt">size=</span><span class="kw">rel</span>(<span class="dv">2</span>), <span class="co">#Tamaño relativo de la letra del título</span></span>
<span id="cb36-15"><a href="proceso-de-análisis-de-los-datos.html#cb36-15"></a>                                  <span class="dt">vjust=</span><span class="dv">2</span>, <span class="co">#Justificación vertical, para separarlo del gráfico</span></span>
<span id="cb36-16"><a href="proceso-de-análisis-de-los-datos.html#cb36-16"></a>                                  <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="co">#Letra negrilla. Otras posibilidades &quot;plain&quot;, &quot;italic&quot;, &quot;bold&quot; y &quot;bold.italic&quot;</span></span>
<span id="cb36-17"><a href="proceso-de-análisis-de-los-datos.html#cb36-17"></a>                                  <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, <span class="co">#Color del texto</span></span>
<span id="cb36-18"><a href="proceso-de-análisis-de-los-datos.html#cb36-18"></a>                                  <span class="dt">lineheight=</span><span class="fl">1.5</span>))<span class="op">+</span></span>
<span id="cb36-19"><a href="proceso-de-análisis-de-los-datos.html#cb36-19"></a><span class="st">  </span><span class="kw">scale_fill_hue</span>(<span class="dt">labels =</span><span class="kw">c</span>(<span class="st">&quot;D. C. la administracion publica&quot;</span>,</span>
<span id="cb36-20"><a href="proceso-de-análisis-de-los-datos.html#cb36-20"></a>                               <span class="st">&quot;D. C. la familia&quot;</span>,</span>
<span id="cb36-21"><a href="proceso-de-análisis-de-los-datos.html#cb36-21"></a>                               <span class="st">&quot;D. C. la libertad&quot;</span>,</span>
<span id="cb36-22"><a href="proceso-de-análisis-de-los-datos.html#cb36-22"></a>                               <span class="st">&quot;D. C. patrominio&quot;</span>,</span>
<span id="cb36-23"><a href="proceso-de-análisis-de-los-datos.html#cb36-23"></a>                               <span class="st">&quot;D. C. la seguridad publica&quot;</span>,</span>
<span id="cb36-24"><a href="proceso-de-análisis-de-los-datos.html#cb36-24"></a>                               <span class="st">&quot;D. C. la vida, el cuerpo y la salud&quot;</span>))</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>En este grafico se evalua los delitos según su tipo, sin considerar a Lima, lo cual nos indica que el mayor rango lo tiene el delito contra el patrimonio, esta vez el valor atípico no se muestra muy distante y no llega a pasar de los 4000 delitos.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="proceso-de-análisis-de-los-datos.html#cb37-1"></a><span class="kw">ggplot</span>(delit2, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Valor)) <span class="op">+</span></span>
<span id="cb37-2"><a href="proceso-de-análisis-de-los-datos.html#cb37-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>( <span class="kw">aes</span>(<span class="dt">fill =</span> delitos)) <span class="op">+</span></span>
<span id="cb37-3"><a href="proceso-de-análisis-de-los-datos.html#cb37-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribuciòn de delitos segùn tipo&quot;</span>,</span>
<span id="cb37-4"><a href="proceso-de-análisis-de-los-datos.html#cb37-4"></a>       <span class="dt">y =</span> <span class="st">&quot;Tipo de delito&quot;</span>) <span class="op">+</span></span>
<span id="cb37-5"><a href="proceso-de-análisis-de-los-datos.html#cb37-5"></a><span class="kw">facet_grid</span>(<span class="kw">vars</span>(delitos))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>En la gráfica apreciamos que los datos del delito contra el patrimonio es mayor están más distribuidos que cualquier otro delito, seguido del delito de seguridad pública.</p>
<p>Nivel de Educaciòn</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="proceso-de-análisis-de-los-datos.html#cb39-1"></a>educ2&lt;-<span class="st"> </span>data2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">6</span><span class="op">:</span><span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-2"><a href="proceso-de-análisis-de-los-datos.html#cb39-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Dep, <span class="dt">names_to =</span> <span class="st">&quot;N.educ&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Valor&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-3"><a href="proceso-de-análisis-de-los-datos.html#cb39-3"></a><span class="st">  </span><span class="kw">group_by</span>(N.educ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-4"><a href="proceso-de-análisis-de-los-datos.html#cb39-4"></a><span class="st">  </span><span class="kw">summarise</span>(N.educ,Valor, Dep)</span>
<span id="cb39-5"><a href="proceso-de-análisis-de-los-datos.html#cb39-5"></a></span>
<span id="cb39-6"><a href="proceso-de-análisis-de-los-datos.html#cb39-6"></a>  <span class="kw">ggplot</span>( educ2, <span class="dt">mapping =</span> <span class="kw">aes</span>( <span class="dt">x =</span> N.educ , <span class="dt">y =</span> Valor , <span class="dt">fill =</span> N.educ))<span class="op">+</span></span>
<span id="cb39-7"><a href="proceso-de-análisis-de-los-datos.html#cb39-7"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb39-8"><a href="proceso-de-análisis-de-los-datos.html#cb39-8"></a>               <span class="dt">width =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-9"><a href="proceso-de-análisis-de-los-datos.html#cb39-9"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>,          <span class="co"># Transparencia</span></span>
<span id="cb39-10"><a href="proceso-de-análisis-de-los-datos.html#cb39-10"></a>               <span class="dt">colour =</span> <span class="st">&quot;#474747&quot;</span>,   <span class="co"># Color del borde</span></span>
<span id="cb39-11"><a href="proceso-de-análisis-de-los-datos.html#cb39-11"></a>               <span class="dt">outlier.colour =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Color atípicos</span></span>
<span id="cb39-12"><a href="proceso-de-análisis-de-los-datos.html#cb39-12"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb39-13"><a href="proceso-de-análisis-de-los-datos.html#cb39-13"></a>    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;beige&quot;</span>)</span>
<span id="cb39-14"><a href="proceso-de-análisis-de-los-datos.html#cb39-14"></a>  )</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Según este gráfico, podemos apreciar que el rango de delitos es mayor en la población que tiene secundaria completa con la mediana que nos indica una simetría entre los datos recogidos, también están el grupo que tiene un nivel educativo de secundaria incompleta.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="proceso-de-análisis-de-los-datos.html#cb40-1"></a><span class="kw">ggplot</span>(educ2, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Valor)) <span class="op">+</span></span>
<span id="cb40-2"><a href="proceso-de-análisis-de-los-datos.html#cb40-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>( <span class="kw">aes</span>(<span class="dt">fill =</span> N.educ)) <span class="op">+</span></span>
<span id="cb40-3"><a href="proceso-de-análisis-de-los-datos.html#cb40-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribuciòn de delitos segùn nivel de educaciòn&quot;,</span></span>
<span id="cb40-4"><a href="proceso-de-análisis-de-los-datos.html#cb40-4"></a><span class="st">       y = &quot;</span>Nivel de educaciòn&quot;) <span class="op">+</span></span>
<span id="cb40-5"><a href="proceso-de-análisis-de-los-datos.html#cb40-5"></a><span class="kw">facet_grid</span>(<span class="kw">vars</span>(N.educ))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>En la gráfica presentada vemos que el grupo con un nivel educativo de secundaria incompleta se muestra más distribuido a lo largo del eje de números de delitos seguido de los que tienen un nivel educativo de secundaria completa.</p>
<p>Analicemos la edad</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="proceso-de-análisis-de-los-datos.html#cb42-1"></a>edad2 &lt;-data2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">21</span><span class="op">:</span><span class="dv">29</span>) <span class="op">%&gt;%</span></span>
<span id="cb42-2"><a href="proceso-de-análisis-de-los-datos.html#cb42-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Dep, <span class="dt">names_to =</span> <span class="st">&quot;edad&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Valor&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-3"><a href="proceso-de-análisis-de-los-datos.html#cb42-3"></a><span class="st">  </span><span class="kw">group_by</span>(edad) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-4"><a href="proceso-de-análisis-de-los-datos.html#cb42-4"></a><span class="st">  </span><span class="kw">summarise</span>(edad,Valor, Dep) </span>
<span id="cb42-5"><a href="proceso-de-análisis-de-los-datos.html#cb42-5"></a></span>
<span id="cb42-6"><a href="proceso-de-análisis-de-los-datos.html#cb42-6"></a>  <span class="kw">ggplot</span>(edad2, <span class="dt">mapping =</span> <span class="kw">aes</span>( <span class="dt">x =</span> edad , <span class="dt">y =</span> Valor , <span class="dt">fill =</span> edad))<span class="op">+</span></span>
<span id="cb42-7"><a href="proceso-de-análisis-de-los-datos.html#cb42-7"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb42-8"><a href="proceso-de-análisis-de-los-datos.html#cb42-8"></a>               <span class="dt">width =</span> <span class="fl">0.25</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-9"><a href="proceso-de-análisis-de-los-datos.html#cb42-9"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.8</span>,          <span class="co"># Transparencia</span></span>
<span id="cb42-10"><a href="proceso-de-análisis-de-los-datos.html#cb42-10"></a>               <span class="dt">colour =</span> <span class="st">&quot;#474747&quot;</span>,   <span class="co"># Color del borde</span></span>
<span id="cb42-11"><a href="proceso-de-análisis-de-los-datos.html#cb42-11"></a>               <span class="dt">outlier.colour =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-12"><a href="proceso-de-análisis-de-los-datos.html#cb42-12"></a><span class="st">  </span><span class="kw">ggtitle</span> (<span class="st">&quot;Evaluacion de delitos </span><span class="ch">\n</span><span class="st">Segun grupo de edad&quot;</span>)<span class="op">+</span><span class="co"># Color atípicos</span></span>
<span id="cb42-13"><a href="proceso-de-análisis-de-los-datos.html#cb42-13"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb42-14"><a href="proceso-de-análisis-de-los-datos.html#cb42-14"></a>    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;beige&quot;</span>),</span>
<span id="cb42-15"><a href="proceso-de-análisis-de-los-datos.html#cb42-15"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Comic Sans MS&quot;</span>,</span>
<span id="cb42-16"><a href="proceso-de-análisis-de-los-datos.html#cb42-16"></a>                              <span class="dt">size=</span><span class="kw">rel</span>(<span class="dv">2</span>), <span class="co">#Tamaño relativo de la letra del título</span></span>
<span id="cb42-17"><a href="proceso-de-análisis-de-los-datos.html#cb42-17"></a>                              <span class="dt">vjust=</span><span class="dv">2</span>, <span class="co">#Justificación vertical, para separarlo del gráfico</span></span>
<span id="cb42-18"><a href="proceso-de-análisis-de-los-datos.html#cb42-18"></a>                              <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="co">#Letra negrilla. Otras posibilidades &quot;plain&quot;, &quot;italic&quot;, &quot;bold&quot; y &quot;bold.italic&quot;</span></span>
<span id="cb42-19"><a href="proceso-de-análisis-de-los-datos.html#cb42-19"></a>                              <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, <span class="co">#Color del texto</span></span>
<span id="cb42-20"><a href="proceso-de-análisis-de-los-datos.html#cb42-20"></a>                              <span class="dt">lineheight=</span><span class="fl">1.5</span>)</span>
<span id="cb42-21"><a href="proceso-de-análisis-de-los-datos.html#cb42-21"></a>  )</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-23-1.png" width="672" />
Sin contar a Lima podemos notar que el rango intercuartlico es más apreciable en todos los grupos etarios siendo los más resaltantes las personas que se encuentra entre los 25 a 29 años y los de 30 a 34 años, la mediana se sitúa casi en el centro de la caja por lo que podríamos decir que la distribución es simétrica.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="proceso-de-análisis-de-los-datos.html#cb43-1"></a><span class="kw">ggplot</span>(edad2, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Valor)) <span class="op">+</span></span>
<span id="cb43-2"><a href="proceso-de-análisis-de-los-datos.html#cb43-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>( <span class="kw">aes</span>(<span class="dt">fill =</span> edad)) <span class="op">+</span></span>
<span id="cb43-3"><a href="proceso-de-análisis-de-los-datos.html#cb43-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Dsitribuciòn de delitos segùn rango de edad&quot;</span>,</span>
<span id="cb43-4"><a href="proceso-de-análisis-de-los-datos.html#cb43-4"></a>       <span class="dt">y =</span> <span class="st">&quot;Grupo de edad&quot;</span>) <span class="op">+</span></span>
<span id="cb43-5"><a href="proceso-de-análisis-de-los-datos.html#cb43-5"></a><span class="kw">facet_grid</span>(<span class="kw">vars</span>(edad))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>En la gráfica presentada vemos que el grupo etario que se muestra más distribuido a lo largo del eje de números de delitos son los que están entre los 25 a 29 años seguidos de los que tienen entre 20 a 24 años, lo que indicaría que los delitos cometidos por ambos grupos etarios sobrepasan los 1000 delitos</p>
</div>
</div>
<div id="análisis-de-componentes-principales" class="section level2">
<h2><span class="header-section-number">5.2</span> Análisis de Componentes Principales</h2>
<p>Con la data anteriormente explorada y verificada, procedemosa realizar los siguientes procedimientos.</p>
<div id="justificación-del-análisis-de-componentes-principales" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Justificación del Análisis de Componentes Principales</h3>
<p>Antes de empezar con el Análisis de Componentes Principales, debemos asegurarnos que nuestras variables cumplan con la caracteristica de multicolinealidad, ello se observa en la alta correlación que existe entre ellas.</p>
<p>Para ello procedemos a nombrar nuestras filas con los nombres de los departamentos ya que no lo necesitamos en el análisis ya que es un dato de tipo caracter.</p>
<p>Para mostrar la correlación en nuestras variables primero estandarizamos nuestras variables y luego ploteamos la correlación.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="proceso-de-análisis-de-los-datos.html#cb45-1"></a>sc_dat1 &lt;-<span class="st"> </span><span class="kw">scale</span>(data2)</span>
<span id="cb45-2"><a href="proceso-de-análisis-de-los-datos.html#cb45-2"></a><span class="kw">pairs.panels</span>(sc_dat1, <span class="dt">gap =</span> <span class="dv">0</span>, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">stars =</span> <span class="ot">TRUE</span>, </span>
<span id="cb45-3"><a href="proceso-de-análisis-de-los-datos.html#cb45-3"></a>             <span class="dt">hist.col =</span> <span class="dv">4</span>, <span class="dt">density =</span> <span class="ot">TRUE</span>,</span>
<span id="cb45-4"><a href="proceso-de-análisis-de-los-datos.html#cb45-4"></a>             <span class="dt">main =</span> <span class="st">&quot;Correlación entre variables&quot;</span></span>
<span id="cb45-5"><a href="proceso-de-análisis-de-los-datos.html#cb45-5"></a>             )</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="proceso-de-análisis-de-los-datos.html#cb46-1"></a>cor_dat1 &lt;-<span class="st"> </span><span class="kw">cor</span>(sc_dat1)</span>
<span id="cb46-2"><a href="proceso-de-análisis-de-los-datos.html#cb46-2"></a><span class="kw">levelplot</span>(</span>
<span id="cb46-3"><a href="proceso-de-análisis-de-los-datos.html#cb46-3"></a>  <span class="kw">as.matrix</span>(cor_dat1),</span>
<span id="cb46-4"><a href="proceso-de-análisis-de-los-datos.html#cb46-4"></a>  <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">90</span>)),</span>
<span id="cb46-5"><a href="proceso-de-análisis-de-los-datos.html#cb46-5"></a>  <span class="dt">col.regions =</span></span>
<span id="cb46-6"><a href="proceso-de-análisis-de-los-datos.html#cb46-6"></a>    <span class="kw">cpt</span>(</span>
<span id="cb46-7"><a href="proceso-de-análisis-de-los-datos.html#cb46-7"></a>      <span class="dt">pal =</span> <span class="st">&quot;cb_seq_YlOrRd_09&quot;</span>, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">rev =</span> F</span>
<span id="cb46-8"><a href="proceso-de-análisis-de-los-datos.html#cb46-8"></a>    ),</span>
<span id="cb46-9"><a href="proceso-de-análisis-de-los-datos.html#cb46-9"></a>  <span class="dt">main =</span> <span class="st">&quot;Correlación entre variables&quot;</span>,</span>
<span id="cb46-10"><a href="proceso-de-análisis-de-los-datos.html#cb46-10"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Variables&quot;</span>,</span>
<span id="cb46-11"><a href="proceso-de-análisis-de-los-datos.html#cb46-11"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Variables&quot;</span></span>
<span id="cb46-12"><a href="proceso-de-análisis-de-los-datos.html#cb46-12"></a>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>En la gráfica anterior podemos observar niveles de correlación que van aproximadamente desde -0.2 a 1, donde en el rango de -0.2 a 0.4 aproximadamente se puede considerar correlación baja entre las variables, mientras que en adelante se puede considerar de regular a buena, observando la gráfica nos percatamos de que las casillas están pintadas en mayor cantidad de la tonalidad guinda, lo cual nos dice que existe la correlación de nuestras variables, con ella podemos justificar el Análisis de Componenetes Principales.</p>
</div>
<div id="proceso-análisis-del-pca" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Proceso análisis del PCA</h3>
<p>Para este análisis ejecutamos las siguientes líneas de código, en el cual la la función <strong>dudi.pca</strong> pertenece a la libreria <strong>de4</strong>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="proceso-de-análisis-de-los-datos.html#cb47-1"></a>pca_dat1 &lt;-<span class="st"> </span><span class="kw">dudi.pca</span>(</span>
<span id="cb47-2"><a href="proceso-de-análisis-de-los-datos.html#cb47-2"></a>  sc_dat1, </span>
<span id="cb47-3"><a href="proceso-de-análisis-de-los-datos.html#cb47-3"></a>  <span class="dt">scale =</span> F, </span>
<span id="cb47-4"><a href="proceso-de-análisis-de-los-datos.html#cb47-4"></a>  <span class="dt">scannf =</span> F, </span>
<span id="cb47-5"><a href="proceso-de-análisis-de-los-datos.html#cb47-5"></a>  <span class="dt">nf =</span> <span class="kw">ncol</span>(sc_dat1)</span>
<span id="cb47-6"><a href="proceso-de-análisis-de-los-datos.html#cb47-6"></a>)</span></code></pre></div>
<p>A continuación veremos el resumen del análsis realizado anteriormente:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="proceso-de-análisis-de-los-datos.html#cb48-1"></a>factoextra<span class="op">::</span><span class="kw">get_eig</span>(pca_dat1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>(<span class="dt">caption=</span><span class="st">&quot;Resumen de PCA&quot;</span>,</span>
<span id="cb48-2"><a href="proceso-de-análisis-de-los-datos.html#cb48-2"></a>                                  <span class="dt">align =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb48-3"><a href="proceso-de-análisis-de-los-datos.html#cb48-3"></a>                                  <span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb48-4"><a href="proceso-de-análisis-de-los-datos.html#cb48-4"></a><span class="st">  </span><span class="kw">kable_material</span>(<span class="dt">html_font =</span> <span class="st">&quot;sans-serif&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb48-5"><a href="proceso-de-análisis-de-los-datos.html#cb48-5"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class=" lightable-material table table-hover" style="font-family: sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-29">Table 5.1: </span>Resumen de PCA
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
eigenvalue
</th>
<th style="text-align:center;">
variance.percent
</th>
<th style="text-align:center;">
cumulative.variance.percent
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Dim.1
</td>
<td style="text-align:center;">
18.82
</td>
<td style="text-align:center;">
70.58
</td>
<td style="text-align:center;">
70.58
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.2
</td>
<td style="text-align:center;">
1.74
</td>
<td style="text-align:center;">
6.52
</td>
<td style="text-align:center;">
77.10
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.3
</td>
<td style="text-align:center;">
1.56
</td>
<td style="text-align:center;">
5.85
</td>
<td style="text-align:center;">
82.95
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.4
</td>
<td style="text-align:center;">
1.37
</td>
<td style="text-align:center;">
5.13
</td>
<td style="text-align:center;">
88.08
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.5
</td>
<td style="text-align:center;">
0.87
</td>
<td style="text-align:center;">
3.26
</td>
<td style="text-align:center;">
91.34
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.6
</td>
<td style="text-align:center;">
0.83
</td>
<td style="text-align:center;">
3.09
</td>
<td style="text-align:center;">
94.44
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.7
</td>
<td style="text-align:center;">
0.37
</td>
<td style="text-align:center;">
1.38
</td>
<td style="text-align:center;">
95.82
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.8
</td>
<td style="text-align:center;">
0.32
</td>
<td style="text-align:center;">
1.21
</td>
<td style="text-align:center;">
97.03
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.9
</td>
<td style="text-align:center;">
0.22
</td>
<td style="text-align:center;">
0.82
</td>
<td style="text-align:center;">
97.85
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.10
</td>
<td style="text-align:center;">
0.17
</td>
<td style="text-align:center;">
0.64
</td>
<td style="text-align:center;">
98.48
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.11
</td>
<td style="text-align:center;">
0.11
</td>
<td style="text-align:center;">
0.42
</td>
<td style="text-align:center;">
98.91
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.12
</td>
<td style="text-align:center;">
0.11
</td>
<td style="text-align:center;">
0.39
</td>
<td style="text-align:center;">
99.30
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.13
</td>
<td style="text-align:center;">
0.08
</td>
<td style="text-align:center;">
0.32
</td>
<td style="text-align:center;">
99.62
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.14
</td>
<td style="text-align:center;">
0.04
</td>
<td style="text-align:center;">
0.14
</td>
<td style="text-align:center;">
99.75
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.15
</td>
<td style="text-align:center;">
0.03
</td>
<td style="text-align:center;">
0.11
</td>
<td style="text-align:center;">
99.87
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.16
</td>
<td style="text-align:center;">
0.02
</td>
<td style="text-align:center;">
0.09
</td>
<td style="text-align:center;">
99.95
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.17
</td>
<td style="text-align:center;">
0.01
</td>
<td style="text-align:center;">
0.02
</td>
<td style="text-align:center;">
99.98
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.18
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.02
</td>
<td style="text-align:center;">
99.99
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.19
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.01
</td>
<td style="text-align:center;">
100.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Dim.20
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
0.00
</td>
<td style="text-align:center;">
100.00
</td>
</tr>
</tbody>
</table>
<p>En este resumen presentado podemos observar los autovalores de los 5 primeros componentes. Sabemos que uno de los objetivos de Análisis de Componentes Principales es reducir la dimensionalidad creando nuevas variabales que contengan la misma información que las variables originales, para reducir está dimensionalidad tenemos uno de los métodos, las cuales nos indican que se retienen las componentes cuyos componentes tengan autovalores mayores a 1, bajo ese criterio observamos que hay 4 autovalores mayores a 1 las cuales podrían ser retennidas, sin embargo seguiremos analizando con otros criterios.</p>
<p>Desglosamos la información de la siguiente manera.
Obtenemos los valores propios:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="proceso-de-análisis-de-los-datos.html#cb49-1"></a>pca_dat1<span class="op">$</span>eig</span></code></pre></div>
<pre><code>##  [1] 1.882258e+01 1.738326e+00 1.559808e+00 1.368499e+00 8.685314e-01
##  [6] 8.250608e-01 3.690182e-01 3.233771e-01 2.179674e-01 1.694674e-01
## [11] 1.123446e-01 1.050819e-01 8.488351e-02 3.637089e-02 2.990117e-02
## [16] 2.319466e-02 5.692017e-03 4.227733e-03 1.546177e-03 7.892811e-04</code></pre>
<p>Obtenemos los vectores propios:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="proceso-de-análisis-de-los-datos.html#cb51-1"></a>pca_dat1<span class="op">$</span>c1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-2"><a href="proceso-de-análisis-de-los-datos.html#cb51-2"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>##               CS1        CS2          CS3         CS4         CS5         CS6
## Pob    0.03346742 0.36308411 -0.067999116 -0.07114734  0.85387408  0.23502694
## NEP   -0.03098843 0.25470115  0.690117974  0.05526576  0.02459348  0.10506340
## S_F   -0.20319145 0.01716818  0.022065255 -0.13222560  0.03293401 -0.31351047
## S_M   -0.22351197 0.01526901 -0.061085050  0.01557517 -0.01043567  0.05611854
## SNE   -0.13680706 0.19035771 -0.049183210  0.50725948  0.06933720 -0.28384755
## NE_PC -0.18403905 0.03507846 -0.005189258  0.43238351 -0.01238721  0.03292307
##               CS7         CS8          CS9        CS10        CS11        CS12
## Pob   -0.08468607  0.08795264 -0.083815135 -0.01832737 -0.09657128  0.04328563
## NEP    0.08483449  0.29514475  0.292951638  0.01147933  0.18328482 -0.14397086
## S_F    0.02002486  0.35938919  0.091739661 -0.18382322  0.23778318 -0.06710041
## S_M    0.01567974  0.01010899 -0.007499957  0.09918437 -0.07242878  0.01862268
## SNE   -0.03506991 -0.27835723  0.495622489 -0.37362499 -0.19404708  0.06208898
## NE_PC -0.14626055  0.15715645 -0.069006529  0.36410747 -0.07872889 -0.31767365
##              CS13        CS14         CS15        CS16        CS17        CS18
## Pob   -0.10119151 -0.08185494  0.002904858  0.04760099 -0.02064505 -0.04459575
## NEP    0.26398644  0.20291652  0.095038987 -0.26501596 -0.06141550 -0.03528636
## S_F   -0.30364284 -0.11428901 -0.266855328  0.05636235  0.44402119  0.01885393
## S_M    0.03598776  0.05606743  0.047213706 -0.04982056  0.01334962 -0.06217277
## SNE   -0.14830370  0.12638430 -0.148833855  0.03235328 -0.09238482 -0.06516584
## NE_PC  0.01121975 -0.30393434 -0.205825684 -0.07643881 -0.17563728  0.10177386
##               CS19        CS20
## Pob    0.098960911  0.03931912
## NEP   -0.009195381 -0.02410225
## S_F    0.048583311 -0.33739345
## S_M    0.053675016  0.02020257
## SNE    0.027792346  0.06194441
## NE_PC -0.261092032 -0.12329414</code></pre>
<p>Otro método a analizar para la retención de componentes principales, es a través de los gráficos de sedimentación, la cual mostramos a continuación.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="proceso-de-análisis-de-los-datos.html#cb53-1"></a><span class="kw">fviz_eig</span>(pca_dat1,</span>
<span id="cb53-2"><a href="proceso-de-análisis-de-los-datos.html#cb53-2"></a>         <span class="dt">choice =</span> <span class="st">&quot;variance&quot;</span>,</span>
<span id="cb53-3"><a href="proceso-de-análisis-de-los-datos.html#cb53-3"></a>         <span class="dt">addlabels =</span> T, </span>
<span id="cb53-4"><a href="proceso-de-análisis-de-los-datos.html#cb53-4"></a>         <span class="dt">barfill =</span>  </span>
<span id="cb53-5"><a href="proceso-de-análisis-de-los-datos.html#cb53-5"></a>           <span class="kw">cpt</span>(</span>
<span id="cb53-6"><a href="proceso-de-análisis-de-los-datos.html#cb53-6"></a>             <span class="dt">pal =</span> <span class="st">&quot;cb_seq_YlOrRd_09&quot;</span>, <span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">rev =</span> T</span>
<span id="cb53-7"><a href="proceso-de-análisis-de-los-datos.html#cb53-7"></a>           ),</span>
<span id="cb53-8"><a href="proceso-de-análisis-de-los-datos.html#cb53-8"></a>         <span class="dt">barcolor =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb53-9"><a href="proceso-de-análisis-de-los-datos.html#cb53-9"></a>         ) <span class="op">+</span></span>
<span id="cb53-10"><a href="proceso-de-análisis-de-los-datos.html#cb53-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Gráfico de sedimentación&quot;) +</span></span>
<span id="cb53-11"><a href="proceso-de-análisis-de-los-datos.html#cb53-11"></a><span class="st">  xlab(label = &quot;</span>Componentes<span class="st">&quot;) + </span></span>
<span id="cb53-12"><a href="proceso-de-análisis-de-los-datos.html#cb53-12"></a><span class="st">  ylab(label =  &quot;</span>% Varianza<span class="st">&quot;)+</span></span>
<span id="cb53-13"><a href="proceso-de-análisis-de-los-datos.html#cb53-13"></a><span class="st">  geom_hline(yintercept = 1)</span></span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>En esta gráfica de sedimentación visualmente observamos que hay una abrupta caída entre la primera y la segunda componente, también se observa una diferencia aproximada entre la cuarta componente y la quinta. Al no tener clara aún seguimos analizando.</p>
<p>Analizamos la correlación entre las variables y los componentes principales</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="proceso-de-análisis-de-los-datos.html#cb54-1"></a><span class="kw">levelplot</span>(</span>
<span id="cb54-2"><a href="proceso-de-análisis-de-los-datos.html#cb54-2"></a>  <span class="kw">as.matrix</span>(pca_dat1<span class="op">$</span>co),</span>
<span id="cb54-3"><a href="proceso-de-análisis-de-los-datos.html#cb54-3"></a>  <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">list</span>(<span class="dt">rot =</span> <span class="dv">90</span>)),</span>
<span id="cb54-4"><a href="proceso-de-análisis-de-los-datos.html#cb54-4"></a>  <span class="dt">col.regions =</span></span>
<span id="cb54-5"><a href="proceso-de-análisis-de-los-datos.html#cb54-5"></a>    <span class="kw">cpt</span>(</span>
<span id="cb54-6"><a href="proceso-de-análisis-de-los-datos.html#cb54-6"></a>      <span class="dt">pal =</span> <span class="st">&quot;cb_seq_YlOrRd_09&quot;</span>, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">rev =</span> T</span>
<span id="cb54-7"><a href="proceso-de-análisis-de-los-datos.html#cb54-7"></a>    ),</span>
<span id="cb54-8"><a href="proceso-de-análisis-de-los-datos.html#cb54-8"></a>  <span class="dt">main =</span> <span class="st">&quot;Correlación entre las variables y los componentes&quot;</span>,</span>
<span id="cb54-9"><a href="proceso-de-análisis-de-los-datos.html#cb54-9"></a>  <span class="dt">xlab =</span> <span class="st">&quot;Variables&quot;</span>,</span>
<span id="cb54-10"><a href="proceso-de-análisis-de-los-datos.html#cb54-10"></a>  <span class="dt">ylab =</span> <span class="st">&quot;Componentes&quot;</span></span>
<span id="cb54-11"><a href="proceso-de-análisis-de-los-datos.html#cb54-11"></a>  )</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Podemos observar que la primera componente tiene la mayor variancia explicada de las variables, ya que tiene mayor correlación con las variables, sin embargo, la variable <strong>NEP</strong> que corresponde al número de establlecimientos penitenciarios no puede ser explicado por la primera componente, se explica de mejor manera con la tercera componente, lo mismo sucede con el <strong>DcAP</strong> que es el Delito contra la Administración Pública, con ello podemos decir que es suficiente retener las tres primeras componentes.</p>
<p>A continuación graficamos la correlación entre las variables y cada una de las componentes.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="proceso-de-análisis-de-los-datos.html#cb55-1"></a><span class="kw">fviz_pca_var</span>(pca_dat1,<span class="dt">repel =</span> <span class="ot">TRUE</span>, <span class="dt">axes =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb55-2"><a href="proceso-de-análisis-de-los-datos.html#cb55-2"></a>             <span class="dt">col.var =</span> <span class="st">&quot;Darkblue&quot;</span>,</span>
<span id="cb55-3"><a href="proceso-de-análisis-de-los-datos.html#cb55-3"></a>             <span class="dt">title =</span> <span class="st">&quot;Correlación Variables - PCA&quot;</span>)<span class="op">+</span></span>
<span id="cb55-4"><a href="proceso-de-análisis-de-los-datos.html#cb55-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<pre><code>## Warning: ggrepel: 14 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="proceso-de-análisis-de-los-datos.html#cb57-1"></a><span class="kw">fviz_pca_var</span>(pca_dat1,<span class="dt">repel =</span> <span class="ot">TRUE</span>, <span class="dt">axes =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb57-2"><a href="proceso-de-análisis-de-los-datos.html#cb57-2"></a>             <span class="dt">col.var =</span> <span class="st">&quot;DarkRed&quot;</span>,</span>
<span id="cb57-3"><a href="proceso-de-análisis-de-los-datos.html#cb57-3"></a>             <span class="dt">title =</span> <span class="st">&quot;Correlación Variables - PCA&quot;</span>)<span class="op">+</span></span>
<span id="cb57-4"><a href="proceso-de-análisis-de-los-datos.html#cb57-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<pre><code>## Warning: ggrepel: 2 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="proceso-de-análisis-de-los-datos.html#cb59-1"></a><span class="kw">fviz_pca_var</span>(pca_dat1,<span class="dt">repel =</span> <span class="ot">TRUE</span>, <span class="dt">axes =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb59-2"><a href="proceso-de-análisis-de-los-datos.html#cb59-2"></a>             <span class="dt">col.var =</span> <span class="st">&quot;Darkgreen&quot;</span>,</span>
<span id="cb59-3"><a href="proceso-de-análisis-de-los-datos.html#cb59-3"></a>             <span class="dt">title =</span> <span class="st">&quot;Correlación Variables - PCA&quot;</span>)<span class="op">+</span></span>
<span id="cb59-4"><a href="proceso-de-análisis-de-los-datos.html#cb59-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<pre><code>## Warning: ggrepel: 4 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>A continuación analizamos la contribución de las variables a las componentes.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="proceso-de-análisis-de-los-datos.html#cb61-1"></a>contrib &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(pca_dat1<span class="op">$</span>co<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb61-2"><a href="proceso-de-análisis-de-los-datos.html#cb61-2"></a><span class="kw">corrplot</span>(contrib, <span class="dt">is.corr =</span> T, <span class="dt">method =</span> <span class="st">&quot;square&quot;</span>, <span class="dt">tl.cex =</span> <span class="dv">1</span>,</span>
<span id="cb61-3"><a href="proceso-de-análisis-de-los-datos.html#cb61-3"></a>         <span class="dt">col =</span> <span class="st">&quot;Darkred&quot;</span>, <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>En esta gráfica de la contribución podemos decir que un valor alto indica una buena representación de la variable frente a una componente, en este caso la mayor parte de las variables contribuyen mejor a la primera componente frente a los demás, el Número de Establecimientos Penitenciarios contribuye mejor a la tercera componente, asimismo el Delito contra el Patrimonio contribuye mejor a la segunda componente pero no en gran manera, por lo cual se optaría por eliminar dicha variable, sin embargo debido a que consideramos una variables importante al igual que la otras variables continuaremos con esta variable, finalmente el Delito contra la Administración Pública contribuye de mejor manera a la segunda componente.</p>
<p>Finalmente obtenemos los scores o puntuaciones que son los resultados del PCA.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="proceso-de-análisis-de-los-datos.html#cb62-1"></a>pca_dat1<span class="op">$</span>li <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb62-2"><a href="proceso-de-análisis-de-los-datos.html#cb62-2"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>##                Axis1      Axis2       Axis3      Axis4      Axis5       Axis6
## AMAZONAS   4.6592322  0.4682256 -0.26296623  0.2020830 -0.7928447  0.23726121
## ANCASH    -3.3659142 -0.2510343  0.07291917 -1.3160442 -0.3299376  0.65394310
## APURIMAC   5.4288592  0.4852533 -0.53267305 -0.4889509 -0.8967455  0.09869183
## AREQUIPA  -1.2073143  0.3245080  0.68079728 -1.7672844 -0.4476072  0.34239061
## AYACUCHO  -1.0586813  1.2736300 -0.84151301  0.1291873 -0.3336993 -1.80205566
## CAJAMARCA  0.4599608  0.6855756  1.25671829  1.6550716 -0.2359188 -0.29351836
##                 Axis7       Axis8       Axis9      Axis10      Axis11
## AMAZONAS  -0.06411345 -0.14819135 -0.04695694  0.24795661 -0.09008412
## ANCASH     0.06124662 -0.22077469 -1.18343466  1.12799238  0.21843109
## APURIMAC   0.06467069  0.39024014  0.05324640 -0.16426119  0.12281357
## AREQUIPA  -0.86774829 -0.62164833  0.58919321 -0.41051720  0.23149451
## AYACUCHO   1.10993426  0.31789707 -0.52712100 -0.37158865 -0.28032847
## CAJAMARCA -1.13919195 -0.04758681  0.25974676 -0.03313159 -0.09961679
##                  Axis12       Axis13      Axis14      Axis15       Axis16
## AMAZONAS  -0.0004345313  0.039456101  0.03353770  0.02401883 -0.001011371
## ANCASH    -0.2270735908 -0.008339418  0.08392285 -0.16155505  0.094854361
## APURIMAC  -0.0453542322 -0.123375094  0.11819218 -0.02885701 -0.121973681
## AREQUIPA  -0.3080894263  0.240669853 -0.43794865 -0.06720839  0.181847471
## AYACUCHO  -0.5102246930  0.425746725 -0.21746129 -0.15345857 -0.157691220
## CAJAMARCA  0.1655631847  0.325227086  0.32148534 -0.47620640 -0.069485307
##                 Axis17       Axis18      Axis19        Axis20
## AMAZONAS   0.186231582  0.195965472  0.02131796  3.759879e-02
## ANCASH    -0.005703207 -0.049541345  0.02480766 -4.586738e-05
## APURIMAC   0.017843133  0.017895171  0.04722415 -1.028009e-01
## AREQUIPA   0.064556812 -0.056801018  0.03239766 -3.294847e-04
## AYACUCHO  -0.012945019 -0.006352622 -0.01128372  1.062197e-02
## CAJAMARCA -0.011123979 -0.033441848 -0.01278913  7.678464e-03</code></pre>
<p>Obtenemos la salida con los componentes retenidos.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="proceso-de-análisis-de-los-datos.html#cb64-1"></a>output_pca &lt;-<span class="st"> </span></span>
<span id="cb64-2"><a href="proceso-de-análisis-de-los-datos.html#cb64-2"></a><span class="st">  </span><span class="kw">as.data.frame</span>(pca_dat1<span class="op">$</span>li) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-3"><a href="proceso-de-análisis-de-los-datos.html#cb64-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">sprintf</span>(<span class="st">&quot;Axis%1$s&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</span></code></pre></div>
<p>También mostramos el gráfico biplot en la que se muestra no solo la correlación entre las variables sino se muestra la ubicación de los individuos, de ella se puede interpretar si estos individuos están o no asociados y en que medida a cada componente.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="proceso-de-análisis-de-los-datos.html#cb65-1"></a><span class="kw">fviz_pca_biplot</span>( </span>
<span id="cb65-2"><a href="proceso-de-análisis-de-los-datos.html#cb65-2"></a>  pca_dat1, <span class="dt">axes =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb65-3"><a href="proceso-de-análisis-de-los-datos.html#cb65-3"></a>  <span class="dt">col.var =</span> <span class="st">&quot;Darkblue&quot;</span>,</span>
<span id="cb65-4"><a href="proceso-de-análisis-de-los-datos.html#cb65-4"></a>  <span class="dt">title =</span> <span class="st">&quot;Gráfica Biplot Comp1 - Comp2&quot;</span>      </span>
<span id="cb65-5"><a href="proceso-de-análisis-de-los-datos.html#cb65-5"></a>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="proceso-de-análisis-de-los-datos.html#cb66-1"></a><span class="kw">fviz_pca_biplot</span>( </span>
<span id="cb66-2"><a href="proceso-de-análisis-de-los-datos.html#cb66-2"></a>  pca_dat1, <span class="dt">axes =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), </span>
<span id="cb66-3"><a href="proceso-de-análisis-de-los-datos.html#cb66-3"></a>  <span class="dt">col.var =</span> <span class="st">&quot;Darkred&quot;</span>,</span>
<span id="cb66-4"><a href="proceso-de-análisis-de-los-datos.html#cb66-4"></a>  <span class="dt">title =</span> <span class="st">&quot;Gráfica Biplot Comp1 - Comp3&quot;</span>      </span>
<span id="cb66-5"><a href="proceso-de-análisis-de-los-datos.html#cb66-5"></a>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="proceso-de-análisis-de-los-datos.html#cb67-1"></a><span class="kw">fviz_pca_biplot</span>( </span>
<span id="cb67-2"><a href="proceso-de-análisis-de-los-datos.html#cb67-2"></a>  pca_dat1, <span class="dt">axes =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb67-3"><a href="proceso-de-análisis-de-los-datos.html#cb67-3"></a>  <span class="dt">col.var =</span> <span class="st">&quot;Darkgreen&quot;</span>,</span>
<span id="cb67-4"><a href="proceso-de-análisis-de-los-datos.html#cb67-4"></a>  <span class="dt">title =</span> <span class="st">&quot;Gráfica Biplot Comp2 - Comp3&quot;</span>      </span>
<span id="cb67-5"><a href="proceso-de-análisis-de-los-datos.html#cb67-5"></a>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
</div>
<div id="análisis-de-cluster" class="section level2">
<h2><span class="header-section-number">5.3</span> Análisis de cluster</h2>
<div id="matriz-de-distancias" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Matriz de distancias</h3>
<p>Después de realizar el Análisis de Componentes Principales se procede a calcular las distancias entre las observaciones, ello se realiza generalmente con el método euclidiano.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="proceso-de-análisis-de-los-datos.html#cb68-1"></a>distancia &lt;-<span class="st"> </span><span class="kw">dist</span>(output_pca, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb68-2"><a href="proceso-de-análisis-de-los-datos.html#cb68-2"></a><span class="kw">fviz_dist</span>(distancia, <span class="dt">gradient =</span> <span class="kw">list</span>(<span class="dt">low =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb68-3"><a href="proceso-de-análisis-de-los-datos.html#cb68-3"></a>                                     <span class="dt">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="metodo-jerárquico" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Metodo Jerárquico</h3>
<p>Como sabemos el método jerarquico no requiere conocer previamente el número de clusters, sin embargo después de construir el dendograma se puede determinar un k-óptimo.</p>
<p>Mostramos a continuación el dendograma, mediante en método de enlace Ward.D</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="proceso-de-análisis-de-los-datos.html#cb69-1"></a>hmodel &lt;-<span class="st"> </span><span class="kw">hclust</span>(distancia, <span class="dt">method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb69-2"><a href="proceso-de-análisis-de-los-datos.html#cb69-2"></a><span class="kw">plot</span>(hmodel, <span class="dt">main =</span> <span class="st">&quot;Dendograma&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Observaciones&quot;</span>,</span>
<span id="cb69-3"><a href="proceso-de-análisis-de-los-datos.html#cb69-3"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Altura&quot;</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="proceso-de-agrupamiento" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Proceso de agrupamiento</h3>
<p>Para la selección de números de clusters ploteamos las alturas del dendograma generado anteriormente.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="proceso-de-análisis-de-los-datos.html#cb70-1"></a><span class="kw">plot</span>(hmodel<span class="op">$</span>height, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Indice&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Altura&quot;</span>)</span>
<span id="cb70-2"><a href="proceso-de-análisis-de-los-datos.html#cb70-2"></a><span class="kw">lines</span>(hmodel<span class="op">$</span>height)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="proceso-de-análisis-de-los-datos.html#cb71-1"></a>hmodel<span class="op">$</span>height</span></code></pre></div>
<pre><code>##  [1]  0.3343879  0.4906082  0.7426353  0.8156944  1.0981926  1.1763628
##  [7]  1.5151379  2.1094300  2.3423849  2.4519075  3.0424427  3.0920537
## [13]  3.5100341  4.3606322  4.7877588  6.8776173  7.6778781  9.2749495
## [19] 19.8232528 43.2894899</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="proceso-de-análisis-de-los-datos.html#cb73-1"></a>(hmodel<span class="op">$</span>height)[<span class="dv">18</span>]</span></code></pre></div>
<pre><code>## [1] 9.274949</code></pre>
<p>En el gráfico anterior se muestra un salto evidente en el indice 18 lo que muestra que a partir de ese punto el agrupamiento es más complicado, lo cual significa que no encuentra similaridad a partir de dicho punto, por lo cual a partir de ahí encontramos 3 clusters. Procedemos a cortar y observar cuales son las observaciones que se agrupan entre sí.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="proceso-de-análisis-de-los-datos.html#cb75-1"></a>output_hc &lt;-<span class="st"> </span><span class="kw">hcut</span>(output_pca, <span class="dt">k =</span> <span class="dv">3</span>)</span>
<span id="cb75-2"><a href="proceso-de-análisis-de-los-datos.html#cb75-2"></a><span class="kw">fviz_dend</span>(output_hc, <span class="dt">rect =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb75-3"><a href="proceso-de-análisis-de-los-datos.html#cb75-3"></a>          <span class="dt">k_colors =</span> <span class="kw">c</span>(<span class="st">&quot;#2E9FDF&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>))</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Otro método para detectar la cantidad de cluster a generar es con función Heatmap, como mostramos a continuación.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="proceso-de-análisis-de-los-datos.html#cb76-1"></a>dist2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(distancia)</span>
<span id="cb76-2"><a href="proceso-de-análisis-de-los-datos.html#cb76-2"></a><span class="kw">heatmap</span>(dist2)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>En el gráfico anterior observamos que se generan 3 cuadrantes en la diagonal lo que ello nos indica es la cantidad de cluster óptimos para el análisis.</p>
</div>
<div id="método-k-means" class="section level3">
<h3><span class="header-section-number">5.3.4</span> Método K-means</h3>
<div id="determinación-óptima-del-número-de-cluster" class="section level4">
<h4><span class="header-section-number">5.3.4.1</span> Determinación óptima del número de cluster</h4>
<p>Mostramos a continuación tres principales métodos de los tantos que hay para obtener el k-óptimo, en la que se observa que los dos primeros métodos nos indican que se deben clusterizar en 3 grupos, mientras que el tercer método nos indica solo un cluster.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="proceso-de-análisis-de-los-datos.html#cb77-1"></a><span class="kw">fviz_nbclust</span>(output_pca, kmeans, <span class="dt">method =</span> <span class="st">&quot;wss&quot;</span>,</span>
<span id="cb77-2"><a href="proceso-de-análisis-de-los-datos.html#cb77-2"></a>             <span class="dt">linecolor =</span> <span class="st">&quot;Darkblue&quot;</span>)<span class="op">+</span></span>
<span id="cb77-3"><a href="proceso-de-análisis-de-los-datos.html#cb77-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Número de Clusters Óptimo&quot;</span>)<span class="op">+</span></span>
<span id="cb77-4"><a href="proceso-de-análisis-de-los-datos.html#cb77-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Número de clusters K&quot;</span>)<span class="op">+</span></span>
<span id="cb77-5"><a href="proceso-de-análisis-de-los-datos.html#cb77-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Total de la suma del cuadrado&quot;</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="proceso-de-análisis-de-los-datos.html#cb78-1"></a><span class="kw">fviz_nbclust</span>(output_pca, kmeans, <span class="dt">method =</span> <span class="st">&quot;silhouette&quot;</span>,</span>
<span id="cb78-2"><a href="proceso-de-análisis-de-los-datos.html#cb78-2"></a>             <span class="dt">linecolor =</span> <span class="st">&quot;Darkred&quot;</span>)<span class="op">+</span></span>
<span id="cb78-3"><a href="proceso-de-análisis-de-los-datos.html#cb78-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Número de Clusters Óptimo&quot;</span>)<span class="op">+</span></span>
<span id="cb78-4"><a href="proceso-de-análisis-de-los-datos.html#cb78-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Número de clusters K&quot;</span>)<span class="op">+</span></span>
<span id="cb78-5"><a href="proceso-de-análisis-de-los-datos.html#cb78-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Ancho medio de silueta&quot;</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-48-2.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="proceso-de-análisis-de-los-datos.html#cb79-1"></a><span class="kw">fviz_nbclust</span>(output_pca, kmeans, <span class="dt">method =</span> <span class="st">&quot;gap_stat&quot;</span>,</span>
<span id="cb79-2"><a href="proceso-de-análisis-de-los-datos.html#cb79-2"></a>             <span class="dt">linecolor =</span> <span class="st">&quot;Darkgreen&quot;</span>)<span class="op">+</span></span>
<span id="cb79-3"><a href="proceso-de-análisis-de-los-datos.html#cb79-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Número de Clusters Óptimo&quot;</span>)<span class="op">+</span></span>
<span id="cb79-4"><a href="proceso-de-análisis-de-los-datos.html#cb79-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Número de clusters K&quot;</span>)<span class="op">+</span></span>
<span id="cb79-5"><a href="proceso-de-análisis-de-los-datos.html#cb79-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Estadisticas de brecha&quot;</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-48-3.png" width="672" /></p>
<p>Para tener mayor seguridad de cuántos cluster agrupar, calculamos con todos los métodos, las cuales al final nos van a indicar cual es el k-óptimo para la mayoría de los métodos.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="proceso-de-análisis-de-los-datos.html#cb80-1"></a>resnumclust&lt;-<span class="kw">NbClust</span>(output_pca, <span class="dt">distance =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="dt">min.nc =</span> <span class="dv">2</span>, <span class="dt">max.nc =</span> <span class="dv">10</span>, <span class="dt">method =</span> <span class="st">&quot;kmeans&quot;</span>, <span class="dt">index =</span> <span class="st">&quot;alllong&quot;</span>)</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<pre><code>## *** : The Hubert index is a graphical method of determining the number of clusters.
##                 In the plot of Hubert index, we seek a significant knee that corresponds to a 
##                 significant increase of the value of the measure i.e the significant peak in Hubert
##                 index second differences plot. 
## </code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
<pre><code>## *** : The D index is a graphical method of determining the number of clusters. 
##                 In the plot of D index, we seek a significant knee (the significant peak in Dindex
##                 second differences plot) that corresponds to a significant increase of the value of
##                 the measure. 
##  
## ******************************************************************* 
## * Among all indices:                                                
## * 5 proposed 2 as the best number of clusters 
## * 10 proposed 3 as the best number of clusters 
## * 1 proposed 5 as the best number of clusters 
## * 6 proposed 7 as the best number of clusters 
## * 2 proposed 8 as the best number of clusters 
## * 3 proposed 10 as the best number of clusters 
## 
##                    ***** Conclusion *****                            
##  
## * According to the majority rule, the best number of clusters is  3 
##  
##  
## *******************************************************************</code></pre>
<p>Graficamos el resultado y observamos que el k-óptimo para más de 15 métodos es 3.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="proceso-de-análisis-de-los-datos.html#cb83-1"></a><span class="kw">fviz_nbclust</span>(resnumclust,</span>
<span id="cb83-2"><a href="proceso-de-análisis-de-los-datos.html#cb83-2"></a>            <span class="dt">barfill =</span> <span class="st">&quot;Darkblue&quot;</span>,</span>
<span id="cb83-3"><a href="proceso-de-análisis-de-los-datos.html#cb83-3"></a>            <span class="dt">barcolor =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></span>
<span id="cb83-4"><a href="proceso-de-análisis-de-los-datos.html#cb83-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Número Óptimo de Clusters - K = 3&quot;</span>)<span class="op">+</span></span>
<span id="cb83-5"><a href="proceso-de-análisis-de-los-datos.html#cb83-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Número de clusters K&quot;</span>)<span class="op">+</span></span>
<span id="cb83-6"><a href="proceso-de-análisis-de-los-datos.html#cb83-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frecuencia entre todos los índices&quot;</span>)</span></code></pre></div>
<pre><code>## Among all indices: 
## ===================
## * 2 proposed  0 as the best number of clusters
## * 1 proposed  1 as the best number of clusters
## * 5 proposed  2 as the best number of clusters
## * 10 proposed  3 as the best number of clusters
## * 1 proposed  5 as the best number of clusters
## * 6 proposed  7 as the best number of clusters
## * 2 proposed  8 as the best number of clusters
## * 3 proposed  10 as the best number of clusters
## 
## Conclusion
## =========================
## * According to the majority rule, the best number of clusters is  3 .</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
</div>
<div id="k-means" class="section level3">
<h3><span class="header-section-number">5.3.5</span> K-means</h3>
<p>Ejecutamos la función del cálculo de cluster K-means que usa el algoritmo estudiado de Hartigan-Wong, sabemos que para ellos previamente se ha definido el k-óptimo lo cual indicamos en este método para la cantidad de centroides, que a diferencia del método jerárquico, en ella no era necesario tener previamente la cantidad de cluster que se quería.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="proceso-de-análisis-de-los-datos.html#cb85-1"></a><span class="kw">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb85-2"><a href="proceso-de-análisis-de-los-datos.html#cb85-2"></a>model &lt;-<span class="st"> </span></span>
<span id="cb85-3"><a href="proceso-de-análisis-de-los-datos.html#cb85-3"></a><span class="st">  </span><span class="kw">kmeans</span>(</span>
<span id="cb85-4"><a href="proceso-de-análisis-de-los-datos.html#cb85-4"></a>    <span class="dt">x =</span> output_pca, <span class="dt">centers =</span> <span class="dv">3</span>, <span class="dt">iter.max =</span> <span class="dv">200</span>,</span>
<span id="cb85-5"><a href="proceso-de-análisis-de-los-datos.html#cb85-5"></a>    <span class="dt">nstart =</span> <span class="dv">200</span>, <span class="dt">algorithm =</span> <span class="st">&quot;Hartigan-Wong&quot;</span>, </span>
<span id="cb85-6"><a href="proceso-de-análisis-de-los-datos.html#cb85-6"></a>    <span class="dt">trace =</span> F</span>
<span id="cb85-7"><a href="proceso-de-análisis-de-los-datos.html#cb85-7"></a>  )</span>
<span id="cb85-8"><a href="proceso-de-análisis-de-los-datos.html#cb85-8"></a><span class="kw">fviz_cluster</span>(model, <span class="dt">data =</span> sc_dat1, <span class="dt">show.clust.cent =</span> <span class="ot">TRUE</span>,</span>
<span id="cb85-9"><a href="proceso-de-análisis-de-los-datos.html#cb85-9"></a>             <span class="dt">frame.type =</span> <span class="st">&quot;convex&quot;</span>, <span class="dt">star.plot =</span> <span class="ot">TRUE</span>, <span class="dt">repel =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb85-10"><a href="proceso-de-análisis-de-los-datos.html#cb85-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Resultados clustering K-means&quot;</span>)<span class="op">+</span></span>
<span id="cb85-11"><a href="proceso-de-análisis-de-los-datos.html#cb85-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Calculamos los valores de silueta para el modelo que representan la similitud de un objeto con los otros objetos de su propio cluster, también debemos precisar que los valores de silueta cercanos a 1indica que el objeto está bien agrupado, es decir que es similiar a los otros objetos de su grupo, y un valor cercano a -1 indica que el objeto está mal agrupado.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="proceso-de-análisis-de-los-datos.html#cb86-1"></a>sil &lt;-<span class="st"> </span>cluster<span class="op">::</span><span class="kw">silhouette</span>(model<span class="op">$</span>cluster, <span class="kw">dist</span>(output_pca))</span>
<span id="cb86-2"><a href="proceso-de-análisis-de-los-datos.html#cb86-2"></a><span class="kw">head</span>(sil)</span></code></pre></div>
<pre><code>##      cluster neighbor sil_width
## [1,]       3        2 0.6361977
## [2,]       2        1 0.4823766
## [3,]       3        2 0.6853277
## [4,]       2        3 0.6455209
## [5,]       2        3 0.5867272
## [6,]       2        3 0.3899353</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="proceso-de-análisis-de-los-datos.html#cb88-1"></a>factoextra<span class="op">::</span><span class="kw">fviz_silhouette</span>(sil)<span class="op">+</span></span>
<span id="cb88-2"><a href="proceso-de-análisis-de-los-datos.html#cb88-2"></a><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></span>
<span id="cb88-3"><a href="proceso-de-análisis-de-los-datos.html#cb88-3"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<pre><code>##   cluster size ave.sil.width
## 1       1    2          0.61
## 2       2   12          0.50
## 3       3    7          0.54</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>Del gráfico de los valores de la silueta del modelo podemos decir que nuestras observaciones se encuntran bien agrupadas, además no se obtinen valores negativos cercanos a -1.</p>
</div>
<div id="k-means-1" class="section level3">
<h3><span class="header-section-number">5.3.6</span> K-means++</h3>
<p>Ahora pasamos a ver una de las variantes del modelo K-means y analizaremos los resultados.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="proceso-de-análisis-de-los-datos.html#cb90-1"></a><span class="kw">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb90-2"><a href="proceso-de-análisis-de-los-datos.html#cb90-2"></a>model2 &lt;-<span class="st"> </span></span>
<span id="cb90-3"><a href="proceso-de-análisis-de-los-datos.html#cb90-3"></a><span class="st">  </span>LICORS<span class="op">::</span><span class="kw">kmeanspp</span>(</span>
<span id="cb90-4"><a href="proceso-de-análisis-de-los-datos.html#cb90-4"></a>    <span class="dt">data =</span> output_pca, <span class="dt">k =</span> <span class="dv">3</span>, </span>
<span id="cb90-5"><a href="proceso-de-análisis-de-los-datos.html#cb90-5"></a>    <span class="dt">start =</span> <span class="st">&quot;random&quot;</span>, <span class="dt">iter.max =</span> <span class="dv">100</span>,</span>
<span id="cb90-6"><a href="proceso-de-análisis-de-los-datos.html#cb90-6"></a>    <span class="dt">nstart =</span> <span class="dv">100</span>, <span class="dt">algorithm =</span> <span class="st">&quot;Hartigan-Wong&quot;</span></span>
<span id="cb90-7"><a href="proceso-de-análisis-de-los-datos.html#cb90-7"></a>  )</span>
<span id="cb90-8"><a href="proceso-de-análisis-de-los-datos.html#cb90-8"></a><span class="kw">fviz_cluster</span>(model2, <span class="dt">data =</span> sc_dat1, <span class="dt">show.clust.cent =</span> <span class="ot">TRUE</span>,</span>
<span id="cb90-9"><a href="proceso-de-análisis-de-los-datos.html#cb90-9"></a>             <span class="dt">frame.type =</span> <span class="st">&quot;convex&quot;</span>, <span class="dt">star.plot =</span> <span class="ot">TRUE</span>, <span class="dt">repel =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb90-10"><a href="proceso-de-análisis-de-los-datos.html#cb90-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Resultados clustering K-means++&quot;</span>)<span class="op">+</span></span>
<span id="cb90-11"><a href="proceso-de-análisis-de-los-datos.html#cb90-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="proceso-de-análisis-de-los-datos.html#cb91-1"></a>sil2 &lt;-<span class="st"> </span>cluster<span class="op">::</span><span class="kw">silhouette</span>(model2<span class="op">$</span>cluster, <span class="kw">dist</span>(output_pca))</span>
<span id="cb91-2"><a href="proceso-de-análisis-de-los-datos.html#cb91-2"></a><span class="kw">head</span>(sil)</span></code></pre></div>
<pre><code>##      cluster neighbor sil_width
## [1,]       3        2 0.6361977
## [2,]       2        1 0.4823766
## [3,]       3        2 0.6853277
## [4,]       2        3 0.6455209
## [5,]       2        3 0.5867272
## [6,]       2        3 0.3899353</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="proceso-de-análisis-de-los-datos.html#cb93-1"></a>factoextra<span class="op">::</span><span class="kw">fviz_silhouette</span>(sil2)<span class="op">+</span></span>
<span id="cb93-2"><a href="proceso-de-análisis-de-los-datos.html#cb93-2"></a><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></span>
<span id="cb93-3"><a href="proceso-de-análisis-de-los-datos.html#cb93-3"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<pre><code>##   cluster size ave.sil.width
## 1       1    2          0.61
## 2       2   12          0.50
## 3       3    7          0.54</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>Pasamos a calcular el indice de cohesion de nuestros resultados, tenemos 2 índices.</p>
<ul>
<li>Índice de Dvies-Boulding</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="proceso-de-análisis-de-los-datos.html#cb95-1"></a>grupo2 &lt;-<span class="st"> </span>model2<span class="op">$</span>cluster</span>
<span id="cb95-2"><a href="proceso-de-análisis-de-los-datos.html#cb95-2"></a>indice2 &lt;-<span class="st"> </span>clusterSim<span class="op">::</span><span class="kw">index.DB</span>(output_pca, grupo2, </span>
<span id="cb95-3"><a href="proceso-de-análisis-de-los-datos.html#cb95-3"></a>                                <span class="dt">centrotypes =</span> <span class="st">&quot;centroids&quot;</span>)</span>
<span id="cb95-4"><a href="proceso-de-análisis-de-los-datos.html#cb95-4"></a>indice2<span class="op">$</span>DB</span></code></pre></div>
<pre><code>## [1] 0.6309333</code></pre>
<ul>
<li>Índice de Dunn</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="proceso-de-análisis-de-los-datos.html#cb97-1"></a>clValid<span class="op">::</span><span class="kw">dunn</span>(<span class="dt">Data =</span> output_pca, <span class="dt">clusters =</span> grupo2, <span class="dt">distance =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<pre><code>## [1] 0.4476964</code></pre>
</div>
<div id="k-medoids-pam" class="section level3">
<h3><span class="header-section-number">5.3.7</span> K-medoids PAM</h3>
<p>El método K-medoids es un método de clustering muy similar a K-means, sabemos que este método es más robusto por lo cual soporta los outliers, debido a que en nuestro Análisis Exploratorio de Datos se evidencia los outliers, este método va de la mano con el uso del cálculo de las distancias con el método Manhattan.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="proceso-de-análisis-de-los-datos.html#cb99-1"></a><span class="kw">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb99-2"><a href="proceso-de-análisis-de-los-datos.html#cb99-2"></a>pam_clusters &lt;-<span class="st"> </span><span class="kw">pam</span>(<span class="dt">x =</span> output_pca, <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">metric =</span> <span class="st">&quot;manhattan&quot;</span>)</span>
<span id="cb99-3"><a href="proceso-de-análisis-de-los-datos.html#cb99-3"></a><span class="kw">fviz_cluster</span>(<span class="dt">object =</span> pam_clusters, <span class="dt">data =</span> sc_dat1, <span class="dt">frame.type =</span> <span class="st">&quot;convex&quot;</span>,</span>
<span id="cb99-4"><a href="proceso-de-análisis-de-los-datos.html#cb99-4"></a>             <span class="dt">repel =</span> <span class="ot">TRUE</span>, <span class="dt">show.clust.cent =</span> <span class="ot">TRUE</span>, <span class="dt">star.plot =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb99-5"><a href="proceso-de-análisis-de-los-datos.html#cb99-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Resultados clustering PAM&quot;</span>) <span class="op">+</span></span>
<span id="cb99-6"><a href="proceso-de-análisis-de-los-datos.html#cb99-6"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="proceso-de-análisis-de-los-datos.html#cb100-1"></a>sil3 &lt;-<span class="st"> </span>cluster<span class="op">::</span><span class="kw">silhouette</span>(pam_clusters<span class="op">$</span>clustering, <span class="kw">dist</span>(output_pca))</span>
<span id="cb100-2"><a href="proceso-de-análisis-de-los-datos.html#cb100-2"></a><span class="kw">head</span>(sil3)</span></code></pre></div>
<pre><code>##      cluster neighbor sil_width
## [1,]       1        2 0.6361977
## [2,]       2        3 0.4823766
## [3,]       1        2 0.6853277
## [4,]       2        1 0.6455209
## [5,]       2        1 0.5867272
## [6,]       2        1 0.3899353</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="proceso-de-análisis-de-los-datos.html#cb102-1"></a>factoextra<span class="op">::</span><span class="kw">fviz_silhouette</span>(sil3)<span class="op">+</span></span>
<span id="cb102-2"><a href="proceso-de-análisis-de-los-datos.html#cb102-2"></a><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></span>
<span id="cb102-3"><a href="proceso-de-análisis-de-los-datos.html#cb102-3"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<pre><code>##   cluster size ave.sil.width
## 1       1    7          0.54
## 2       2   12          0.50
## 3       3    2          0.61</code></pre>
<p><img src="BOOK_DELITOS_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="adquisicion-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resultados.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
