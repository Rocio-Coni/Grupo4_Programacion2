---
title: "Grupo4_Tarea1"
author: 
- name: "Chavez Chipana Joel"
- name: "Coba Bautista Kevin"
- name: "Conislla Huamanyalli Rocio"
- name: "Silvestre Jimenez Brenda"
- name: "Tuanama Satalaya Pierina"
date: "10/7/2021"
output: html_document
---

## Parte 1

**1. Calcula los valores numèricos aproximados de:** 

a) $\frac{0.3 \cdot 0.15}{0.3 \cdot 0.15 + 0.2 \cdot 0.8 + 0.5 \cdot 0.12}$


```{r}
a_1 <- (0.3*0.15)
a <- a_1/(a_1 + (0.2*0.8) + (0.5*0.12))
a
```

b) $\frac{5^6}{6!} e^{-5}$

```{r}
b_1 <- (5^6)
b_2 <- factorial(6)
b_3 <- exp(-5)
b   <- (b_1/b_2)*b_3
b
```

c) $\begin{pmatrix} 20 \\ 7 \end{pmatrix} 0.4^7  0.6^{13}$

```{r}
c <- choose(20,7)*(0.4^7)*(0.6)^13
c
```

**2. Realizar la siguiente suma**

a) $1+2+3+...+1000$

```{r}
sum(1:1000)
```
b) $1+2+4+8+16+...+1024$

```{r}
sum(2^(0:10))
```

**3. El vector  `grupo` representa el grupo al que pertenece una serie de alumnos**

Para desarrollar los siguientes ejercios debemos cargar las variables almacenadas en el siguiente archivo [Rdata](https://goo.gl/uDzU8v)

```{r}
load("datos.RData")
```


a) ¿Cuántos elementos tiene?

```{r}

length(grupo)
```

b) ¿En qué posiciones del vector está la letra "A"?

```{r}
which(grupo == "A")
```

**4. El vector `nota` representa la nota de un examen de los alumnos que están en los grupos del vector `grupo`.**

a) ¿Cuanto suman todas las notas?

```{r}
sum(nota)
```
b) ¿Cual es la media aritmética de todas las notas?

```{r}
mean(nota)
```
c) ¿En qué posiciones están las notas mayores de *7.0*?

```{r}
which(nota > 7)
```
d) Visualiza las notas ordenadas de mayor a menor

```{r}
nota_d <- sort(nota, decreasing = T)
head(nota_d)
```
e) ¿En qué posición está la nota máxima?

```{r}
which(nota == max(nota))
```

**5. A partir de los vectores `grupo` y `nota` definidos.**

```{r message=FALSE, warning=FALSE}
library(tidyverse)
nota_grupo <- data.frame(grupo,nota)
head(nota_grupo)

```

a) Suma las notas de los 10 primeros alumnos del vector

```{r}
a_5 <-sum(nota_grupo$nota[1:10])
a_5
```
b) ¿Cuántos alumnos hay del grupo *C*?

```{r}
b_5 <- subset(nota_grupo, grupo =="C")
count(b_5)
```

c) ¿Cuántos alumnos han aprobado?

```{r}
c_5 <- count(subset(nota_grupo , nota > 5))
c_5
```

d) ¿Cuántos alumnos del grupo *B* han aprobado?

```{r}
d_5 <- subset(nota_grupo, grupo == "B" & nota > 5 )
d_5
count(d_5)
```

e) ¿Qué porcentaje de alumnos del grupo *C* han aprobado?

```{r}
aproC <- subset(nota_grupo, grupo =="C"& nota > 5)
e_5 <- (count(aproC)/count(b_5))*100
e_5
```

f) ¿De qué grupos son la máxima y mínima notas de toda la muestra?

```{r}
max(nota[grupo == "A"])
```

g) Nota media de los alumnos de grupo *A* y *B*, juntos, considerando sólo a los que han aprobado.

```{r}
g_1 <- nota[ grupo=='A' & nota >5]
g_2 <- nota[ grupo=='B' & nota >5]
g_3 <- c(g_1,g_2)
g <- round(mean(g_3),3)
g
```


**6. Calcula el percentil 66 de las notas de todos los alumnos, y también de los alumnos del grupo C.**

```{r}
per66 <- quantile(nota,0.66)
per66
quantile(nota[ grupo=="C"] , 0.66)
```

**7. Un alumno tiene una nota de 4.9. ¿Qué porcentaje, del total de alumnos, tiene una nota menor o igual que la suya? ¿Y qué porcentaje tiene una nota mayor o igual que la suya?**

```{r}
por_c <-subset(nota_grupo, nota >=4.9)
(count(por_c)/count(nota_grupo))*100
por_cmn <-subset(nota_grupo, nota <=4.9)
(count(por_cmn)/count(nota_grupo))*100
```

**8. Realiza el gráfico de diagramas de caja de las notas de cada grupo, para poder comparar el nivel de cada uno de ellos.**

```{r}
par(mfrow = c(2,3))
boxplot(nota[grupo == "A"], main = "Grupo A")
boxplot(nota[grupo == "B"], main = "Grupo B")
boxplot(nota[grupo == "C"], main = "Grupo C")
boxplot(nota[grupo == "D"], main = "Grupo D")
boxplot(nota[grupo == "E"], main = "Grupo E")
```

**9. Si la variable `conc` recoge la concentración de plomo (en ppm) en el aire de cierta zona durante un día completo**

a) ¿Cuál ha sido la concentración máxima?

```{r}
max(conc)
```

b) ¿En cuántos de los muestreos se ha superado la concentración de 40.0 ppm?

```{r}
which(conc > 40) %>%  length()
```

c) ¿Cuál ha sido la concentración media del día?

```{r}
mean(conc)
```

d) ¿Cuáles fueron las 10 mediciones más bajas del día?

```{r}
conc1 <- sort(conc)
conc1[1:10]
```

e) Si la primera medida fue a las 00:00. ¿A qué hora del día se alcanzó la concentración máxima?

```{r}
# Creaamos una secuencia de datos de fecha con inicio en la hora pedida:
date1 <- seq(
  as.POSIXct("2021-01-01 00:00"),
  length.out = length(conc),
  by = "5 min"
)

#Creamos un data frame con los datos de concentracion de plomo y las fechas 
df03 <- data.frame(conc, date1)

#Consultamos cual es el valor maximo de concentracion y a su vez nos trae el dato de la hora en que fue tomada
df03[conc == max(conc),]
```


## Parte 3

**15. Manipule los dataframe según se solicite**

Se tiene el conjuntos de datos de precipitación diaria (período 1980 - 2013) de ciertas estaciones meteorológicas (**raingaugeDataset.csv**), donde cada una de estas están asociadas a un código único (**p.e. qc00000208**). Asimismo, se tiene una lista con los nombres, códigos, coordenadas y elevación de cada una de las estaciones (**listRaingauge.csv**).

A cada grupo le corresponde la siguiente estación:

- **Grupo 01**: MALLARES
- **Grupo 02**: TABACONAS
- **Grupo 03**: PUERTO PIZARRO
- **Grupo 04**: MORROPON
- **Grupo 05**: SAN MIGUEL
- **Grupo 06**: CHULUCANAS
- **Grupo 07**: LAMBAYEQUE
- **Grupo 08**: EL LIMON
- **Grupo 09**: EL SALTO
- **Grupo 10**: CHUSIS

```{r}
library(tidyverse)
data2 <- as_tibble(read.csv("raingaugeDataset.csv"))
names(data2)
data3 <- as_tibble(read.csv("listRaingauge.csv"))
names(data3)

est <- dplyr::select(data3, NOM_EST, CODIGO) %>% 
  dplyr::filter(NOM_EST == "MORROPON")
```

De lo descrito anteriormente, se solicita:

a) Determine la cantidad de **missing values** de la serie de tiempo a paso diario.
```{r}
data2 %>% dplyr::mutate(date = as.Date(date, format = "%d/%m/%Y")) %>%
  rename(pp = qc00000235) %>% 
  dplyr::select(date, pp) %>%
  group_by(date) %>% 
  mutate(missVal = sum(is.na(pp)))
```
b) Calcule la serie de tiempo de precipitación **acumulada mensual** (si el # de días con missing values, en un mes, supera el 10%, la precipitación acumulada mensual será considerado como un **`NA`**).
```{r}
ejerc2 <- data2 %>% dplyr::mutate(date = as.Date(date, format = "%d/%m/%Y")) %>% 
  rename(pp = qc00000235) %>%
  dplyr::select(date, pp) %>%
  group_by(date = str_sub(date, 1, 7)) %>% 
  mutate(missVal = sum(is.na(pp)) * 100 / n()) %>%   
  summarize(
    pp = sum(pp , na.rm = T),
    missVal = unique(missVal)
  ) %>% 
  mutate(
    pp = ifelse(missVal >= 10 , NA, pp),
    date = as.Date(sprintf("%1$s-01", date)), #Para agregar el 01 a la fecha
    month= str_sub(date, 6, 7)
  )
```
c) Determine la cantidad de **missing values** de la serie de tiempo a paso mensual.
```{r}
sum(is.na(ejerc2$pp))
max(ejerc2$pp, na.rm = T)
min(ejerc2$pp, na.rm = T)
```
d) Cree una función que calcule, a partir de los datos de preicpitación mensual, la **climatología (Ene-Dic)** para el **período 1980-2010**.
```{r}
ejerc4 <- function(datax){
  rango <- filter(datax, date >= "1980-01-01" & date <="2010-12-31") 
  monthx <- group_by(rango, month)
  mediax <- summarise(monthx, ppmean= mean(pp, na.rm = T))
  return (mediax)
}
ejerc4(ejerc2)
```
e) Poltear (boxplot) la variabilidad de los valores mensuales (Ene-Dic) para el período 1980-2013.
```{r message=FALSE, warning=FALSE}
ggplot(ejerc2, aes(month, pp, fill=month)) + 
  ggtitle("Variabilidad de los valores mensuales entre 1980-2013")+
  labs(x = "Meses", 
       y = "Precipitación")+
  geom_boxplot()+
  theme_bw() + 
  theme(
    panel.background = element_rect(fill = "lightblue"),
    panel.grid.minor = element_line(linetype = "dotted")
  )+
  scale_x_discrete(
    labels = month.abb,
  )+
  labs(caption = "Interpretación: Se observa que entre los meses de enero y abril hay mayor
       variabilidad de los datos de precipitación siendo el mes de marzo el 
       más resaltante, y los meses de mayo a diciembre tienden mantener valores
       nulos ya que es temporada seca. También se puede observar que durante
       todos los meses se presentan valores atípicos debido a errores de lectura
       o anomalías")

```
